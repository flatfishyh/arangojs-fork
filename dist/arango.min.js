(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.arangojs=f()}})(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=aqlQuery;var _collection=require("./collection");function aqlQuery(strings){var bindVars={};var query=strings[0];for(var _len=arguments.length,args=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key]}for(var i=0;i<args.length;i++){var value=args[i];var _name="value"+i;if(value instanceof _collection._BaseCollection||value.constructor&&value.constructor.name==="ArangoCollection"){_name="@"+_name;value=typeof value.name==="function"?value.name():value.name}bindVars[_name]=value;query+="@"+_name+strings[i+1]}return{query:query,bindVars:bindVars}}module.exports=exports["default"]},{"./collection":2}],2:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _get2=function get(_x,_x2,_x3){var _again=true;_function:while(_again){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=undefined;_again=false;if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{_x=parent;_x2=property;_x3=receiver;_again=true;continue _function}}else if("value"in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}}};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();exports["default"]=construct;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var _extend=require("extend");var _extend2=_interopRequireDefault(_extend);var _cursor=require("./cursor");var _cursor2=_interopRequireDefault(_cursor);var types={DOCUMENT_COLLECTION:2,EDGE_COLLECTION:3};exports.types=types;var BaseCollection=function(){function BaseCollection(connection,name){_classCallCheck(this,BaseCollection);this._connection=connection;this._api=this._connection.route("_api");this.name=name}_createClass(BaseCollection,[{key:"_documentHandle",value:function _documentHandle(documentHandle){if(documentHandle._id){documentHandle=documentHandle._id}else if(documentHandle._key){documentHandle=documentHandle._key}if(documentHandle.indexOf("/")===-1){documentHandle=this.name+"/"+documentHandle}return documentHandle}},{key:"_indexHandle",value:function _indexHandle(indexHandle){if(indexHandle.id){indexHandle=indexHandle.id}if(indexHandle.indexOf("/")===-1){indexHandle=this.name+"/"+indexHandle}return indexHandle}},{key:"_get",value:function _get(path,opts,cb){if(typeof opts==="function"){cb=opts;opts=undefined}var _connection$promisify=this._connection.promisify(cb);var promise=_connection$promisify.promise;var callback=_connection$promisify.callback;this._api.get("collection/"+this.name+"/"+path,opts,function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"_put",value:function _put(path,data,cb){var _connection$promisify2=this._connection.promisify(cb);var promise=_connection$promisify2.promise;var callback=_connection$promisify2.callback;this._api.put("collection/"+this.name+"/"+path,data,function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"get",value:function get(cb){var _connection$promisify3=this._connection.promisify(cb);var promise=_connection$promisify3.promise;var callback=_connection$promisify3.callback;this._api.get("collection/"+this.name,function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"create",value:function create(properties,cb){if(typeof properties==="function"){cb=properties;properties=undefined}var _connection$promisify4=this._connection.promisify(cb);var promise=_connection$promisify4.promise;var callback=_connection$promisify4.callback;this._api.post("collection",(0,_extend2["default"])({},properties,{name:this.name,type:this.type}),function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"properties",value:function properties(cb){return this._get("properties",cb)}},{key:"count",value:function count(cb){return this._get("count",cb)}},{key:"figures",value:function figures(cb){return this._get("figures",cb)}},{key:"revision",value:function revision(cb){return this._get("revision",cb)}},{key:"checksum",value:function checksum(opts,cb){return this._get("checksum",opts,cb)}},{key:"load",value:function load(count,cb){if(typeof count==="function"){cb=count;count=undefined}return this._put("load",typeof count==="boolean"?{count:count}:undefined,cb)}},{key:"unload",value:function unload(cb){return this._put("unload",undefined,cb)}},{key:"setProperties",value:function setProperties(properties,cb){return this._put("properties",properties,cb)}},{key:"rename",value:function rename(name,cb){var _this=this;var _connection$promisify5=this._connection.promisify(cb);var promise=_connection$promisify5.promise;var callback=_connection$promisify5.callback;this._api.put("collection/"+this.name+"/rename",{name:name},function(err,res){if(err)callback(err);else{_this.name=name;callback(null,res.body)}});return promise}},{key:"rotate",value:function rotate(cb){return this._put("rotate",undefined,cb)}},{key:"truncate",value:function truncate(cb){return this._put("truncate",undefined,cb)}},{key:"drop",value:function drop(cb){var _connection$promisify6=this._connection.promisify(cb);var promise=_connection$promisify6.promise;var callback=_connection$promisify6.callback;this._api["delete"]("collection/"+this.name,function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"replace",value:function replace(documentHandle,newValue,opts,cb){if(typeof opts==="function"){cb=opts;opts=undefined}var _connection$promisify7=this._connection.promisify(cb);var promise=_connection$promisify7.promise;var callback=_connection$promisify7.callback;this._api.put(this._documentPath(documentHandle),newValue,(0,_extend2["default"])({},opts,{collection:this.name}),function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"update",value:function update(documentHandle,newValue,opts,cb){if(typeof opts==="function"){cb=opts;opts=undefined}var _connection$promisify8=this._connection.promisify(cb);var promise=_connection$promisify8.promise;var callback=_connection$promisify8.callback;this._api.patch(this._documentPath(documentHandle),newValue,(0,_extend2["default"])({},opts,{collection:this.name}),function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"remove",value:function remove(documentHandle,opts,cb){if(typeof opts==="function"){cb=opts;opts=undefined}var _connection$promisify9=this._connection.promisify(cb);var promise=_connection$promisify9.promise;var callback=_connection$promisify9.callback;this._api["delete"](this._documentPath(documentHandle),(0,_extend2["default"])({},opts,{collection:this.name}),function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"list",value:function list(type,cb){if(typeof type==="function"){cb=type;type=undefined}if(!type)type="id";var _connection$promisify10=this._connection.promisify(cb);var promise=_connection$promisify10.promise;var callback=_connection$promisify10.callback;this._api.get("document",{type:type,collection:this.name},function(err,res){return err?callback(err):callback(null,res.body.documents)});return promise}},{key:"all",value:function all(opts,cb){var _this2=this;if(typeof opts==="function"){cb=opts;opts=undefined}var _connection$promisify11=this._connection.promisify(cb);var promise=_connection$promisify11.promise;var callback=_connection$promisify11.callback;this._api.put("simple/all",(0,_extend2["default"])({},opts,{collection:this.name}),function(err,res){return err?callback(err):callback(null,new _cursor2["default"](_this2._connection,res.body))});return promise}},{key:"any",value:function any(cb){var _connection$promisify12=this._connection.promisify(cb);var promise=_connection$promisify12.promise;var callback=_connection$promisify12.callback;this._api.put("simple/any",{collection:this.name},function(err,res){return err?callback(err):callback(null,res.document)});return promise}},{key:"first",value:function first(opts,cb){if(typeof opts==="function"){cb=opts;opts=undefined}if(typeof opts==="number"){opts={count:opts}}var _connection$promisify13=this._connection.promisify(cb);var promise=_connection$promisify13.promise;var callback=_connection$promisify13.callback;this._api.put("simple/first",(0,_extend2["default"])({},opts,{collection:this.name}),function(err,res){return err?callback(err):callback(null,res.result)});return promise}},{key:"last",value:function last(opts,cb){if(typeof opts==="function"){cb=opts;opts=undefined}if(typeof opts==="number"){opts={count:opts}}var _connection$promisify14=this._connection.promisify(cb);var promise=_connection$promisify14.promise;var callback=_connection$promisify14.callback;this._api.put("simple/last",(0,_extend2["default"])({},opts,{collection:this.name}),function(err,res){return err?callback(err):callback(null,res.result)});return promise}},{key:"byExample",value:function byExample(example,opts,cb){var _this3=this;if(typeof opts==="function"){cb=opts;opts=undefined}var _connection$promisify15=this._connection.promisify(cb);var promise=_connection$promisify15.promise;var callback=_connection$promisify15.callback;this._api.put("simple/by-example",(0,_extend2["default"])({},opts,{example:example,collection:this.name}),function(err,res){return err?callback(err):callback(null,new _cursor2["default"](_this3._connection,res.body))});return promise}},{key:"firstExample",value:function firstExample(example,cb){var _connection$promisify16=this._connection.promisify(cb);var promise=_connection$promisify16.promise;var callback=_connection$promisify16.callback;this._api.put("simple/first-example",{example:example,collection:this.name},function(err,res){return err?callback(err):callback(null,res.document)});return promise}},{key:"removeByExample",value:function removeByExample(example,opts,cb){if(typeof opts==="function"){cb=opts;opts=undefined}var _connection$promisify17=this._connection.promisify(cb);var promise=_connection$promisify17.promise;var callback=_connection$promisify17.callback;this._api.put("simple/remove-by-example",(0,_extend2["default"])({},opts,{example:example,collection:this.name}),function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"replaceByExample",value:function replaceByExample(example,newValue,opts,cb){if(typeof opts==="function"){cb=opts;opts=undefined}var _connection$promisify18=this._connection.promisify(cb);var promise=_connection$promisify18.promise;var callback=_connection$promisify18.callback;this._api.put("simple/replace-by-example",(0,_extend2["default"])({},opts,{example:example,newValue:newValue,collection:this.name}),function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"updateByExample",value:function updateByExample(example,newValue,opts,cb){if(typeof opts==="function"){cb=opts;opts=undefined}var _connection$promisify19=this._connection.promisify(cb);var promise=_connection$promisify19.promise;var callback=_connection$promisify19.callback;this._api.put("simple/update-by-example",(0,_extend2["default"])({},opts,{example:example,newValue:newValue,collection:this.name}),function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"lookupByKeys",value:function lookupByKeys(keys,cb){var _connection$promisify20=this._connection.promisify(cb);var promise=_connection$promisify20.promise;var callback=_connection$promisify20.callback;this._api.put("simple/lookup-by-keys",{keys:keys,collection:this.name},function(err,res){return err?callback(err):callback(null,res.body.documents)});return promise}},{key:"removeByKeys",value:function removeByKeys(keys,opts,cb){if(typeof opts==="function"){cb=opts;opts=undefined}var _connection$promisify21=this._connection.promisify(cb);var promise=_connection$promisify21.promise;var callback=_connection$promisify21.callback;this._api.put("simple/remove-by-keys",(0,_extend2["default"])({},opts,{keys:keys,collection:this.name}),function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"import",value:function _import(data,opts,cb){if(typeof opts==="function"){cb=opts;opts=undefined}var _connection$promisify22=this._connection.promisify(cb);var promise=_connection$promisify22.promise;var callback=_connection$promisify22.callback;this._api.request({method:"POST",path:"import",body:data,ld:Boolean(!opts||opts.type!=="array"),qs:(0,_extend2["default"])({type:"auto"},opts,{collection:this.name})},function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"indexes",value:function indexes(cb){var _connection$promisify23=this._connection.promisify(cb);var promise=_connection$promisify23.promise;var callback=_connection$promisify23.callback;this._api.get("index",{collection:this.name},function(err,res){return err?callback(err):callback(null,res.body.indexes)});return promise}},{key:"index",value:function index(indexHandle,cb){var _connection$promisify24=this._connection.promisify(cb);var promise=_connection$promisify24.promise;var callback=_connection$promisify24.callback;this._api.get("index/"+this._indexHandle(indexHandle),function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"createIndex",value:function createIndex(details,cb){var _connection$promisify25=this._connection.promisify(cb);var promise=_connection$promisify25.promise;var callback=_connection$promisify25.callback;this._api.post("index",details,{collection:this.name},function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"dropIndex",value:function dropIndex(indexHandle,cb){var _connection$promisify26=this._connection.promisify(cb);var promise=_connection$promisify26.promise;var callback=_connection$promisify26.callback;this._api["delete"]("index/"+this._indexHandle(indexHandle),function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"createCapConstraint",value:function createCapConstraint(size,cb){if(typeof size==="number"){size={size:size}}var _connection$promisify27=this._connection.promisify(cb);var promise=_connection$promisify27.promise;var callback=_connection$promisify27.callback;this._api.post("index",(0,_extend2["default"])({},size,{type:"cap"}),{collection:this.name},function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"createHashIndex",value:function createHashIndex(fields,opts,cb){if(typeof opts==="function"){cb=opts;opts=undefined}if(typeof fields==="string"){fields=[fields]}if(typeof opts==="boolean"){opts={unique:opts}}var _connection$promisify28=this._connection.promisify(cb);var promise=_connection$promisify28.promise;var callback=_connection$promisify28.callback;this._api.post("index",(0,_extend2["default"])({unique:false},opts,{type:"hash",fields:fields}),{collection:this.name},function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"createSkipList",value:function createSkipList(fields,opts,cb){if(typeof opts==="function"){cb=opts;opts=undefined}if(typeof fields==="string"){fields=[fields]}if(typeof opts==="boolean"){opts={unique:opts}}var _connection$promisify29=this._connection.promisify(cb);var promise=_connection$promisify29.promise;var callback=_connection$promisify29.callback;this._api.post("index",(0,_extend2["default"])({unique:false},opts,{type:"skiplist",fields:fields}),{collection:this.name},function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"createGeoIndex",value:function createGeoIndex(fields,opts,cb){if(typeof opts==="function"){cb=opts;opts=undefined}if(typeof fields==="string"){fields=[fields]}var _connection$promisify30=this._connection.promisify(cb);var promise=_connection$promisify30.promise;var callback=_connection$promisify30.callback;this._api.post("index",(0,_extend2["default"])({},opts,{fields:fields,type:"geo"}),{collection:this.name},function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"createFulltextIndex",value:function createFulltextIndex(fields,minLength,cb){if(typeof minLength==="function"){cb=minLength;minLength=undefined}if(typeof fields==="string"){fields=[fields]}if(minLength)minLength=Number(minLength);var _connection$promisify31=this._connection.promisify(cb);var promise=_connection$promisify31.promise;var callback=_connection$promisify31.callback;this._api.post("index",{fields:fields,minLength:minLength,type:"fulltext"},{collection:this.name},function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"fulltext",value:function fulltext(attribute,query,opts,cb){var _this4=this;if(typeof opts==="function"){cb=opts;opts=undefined}if(!opts)opts={};if(opts.index)opts.index=this._indexHandle(opts.index);var _connection$promisify32=this._connection.promisify(cb);var promise=_connection$promisify32.promise;var callback=_connection$promisify32.callback;this._api.put("simple/fulltext",(0,_extend2["default"])({},opts,{attribute:attribute,query:query,collection:this.name}),function(err,res){return err?callback(err):callback(null,new _cursor2["default"](_this4._connection,res.body))});return promise}}]);return BaseCollection}();var DocumentCollection=function(_BaseCollection){_inherits(DocumentCollection,_BaseCollection);function DocumentCollection(){_classCallCheck(this,DocumentCollection);_get2(Object.getPrototypeOf(DocumentCollection.prototype),"constructor",this).apply(this,arguments);this.type=types.DOCUMENT_COLLECTION}_createClass(DocumentCollection,[{key:"_documentPath",value:function _documentPath(documentHandle){return"document/"+this._documentHandle(documentHandle)}},{key:"document",value:function document(documentHandle,cb){var _connection$promisify33=this._connection.promisify(cb);var promise=_connection$promisify33.promise;var callback=_connection$promisify33.callback;this._api.get("document/"+this._documentHandle(documentHandle),function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"save",value:function save(data,cb){var _connection$promisify34=this._connection.promisify(cb);var promise=_connection$promisify34.promise;var callback=_connection$promisify34.callback;this._api.post("document",data,{collection:this.name},function(err,res){return err?callback(err):callback(null,res.body)});return promise}}]);return DocumentCollection}(BaseCollection);var EdgeCollection=function(_BaseCollection2){_inherits(EdgeCollection,_BaseCollection2);function EdgeCollection(){_classCallCheck(this,EdgeCollection);_get2(Object.getPrototypeOf(EdgeCollection.prototype),"constructor",this).apply(this,arguments);this.type=types.EDGE_COLLECTION}_createClass(EdgeCollection,[{key:"_documentPath",value:function _documentPath(documentHandle){return"edge/"+this._documentHandle(documentHandle)}},{key:"edge",value:function edge(documentHandle,cb){var _connection$promisify35=this._connection.promisify(cb);var promise=_connection$promisify35.promise;var callback=_connection$promisify35.callback;this._api.get("edge/"+this._documentHandle(documentHandle),function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"save",value:function save(data,fromId,toId,cb){var _connection$promisify36=this._connection.promisify(cb);var promise=_connection$promisify36.promise;var callback=_connection$promisify36.callback;this._api.post("edge",data,{collection:this.name,from:this._documentHandle(fromId),to:this._documentHandle(toId)},function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"_edges",value:function _edges(documentHandle,direction,cb){var _connection$promisify37=this._connection.promisify(cb);var promise=_connection$promisify37.promise;var callback=_connection$promisify37.callback;this._api.get("edges/"+this.name,{direction:direction,vertex:this._documentHandle(documentHandle)},function(err,res){return err?callback(err):callback(null,res.body.edges)});return promise}},{key:"edges",value:function edges(vertex,cb){return this._edges(vertex,undefined,cb)}},{key:"inEdges",value:function inEdges(vertex,cb){return this._edges(vertex,"in",cb)}},{key:"outEdges",value:function outEdges(vertex,cb){return this._edges(vertex,"out",cb)}},{key:"traversal",value:function traversal(startVertex,opts,cb){if(typeof opts==="function"){cb=opts;opts=undefined}var _connection$promisify38=this._connection.promisify(cb);var promise=_connection$promisify38.promise;var callback=_connection$promisify38.callback;this._api.post("traversal",(0,_extend2["default"])({},opts,{startVertex:startVertex,edgeCollection:this.name}),function(err,res){return err?callback(err):callback(null,res.body.result)});return promise}}]);return EdgeCollection}(BaseCollection);function construct(connection,body){var Collection=body.type===types.EDGE_COLLECTION?EdgeCollection:DocumentCollection;return new Collection(connection,body.name)}exports.EdgeCollection=EdgeCollection;exports.DocumentCollection=DocumentCollection;exports._BaseCollection=BaseCollection},{"./cursor":4,extend:"extend"}],3:[function(require,module,exports){(function(Buffer){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var _utilPromisify=require("./util/promisify");var _utilPromisify2=_interopRequireDefault(_utilPromisify);var _httpErrors=require("http-errors");var _httpErrors2=_interopRequireDefault(_httpErrors);var _extend=require("extend");var _extend2=_interopRequireDefault(_extend);var _querystring=require("querystring");var _querystring2=_interopRequireDefault(_querystring);var _utilRequest=require("./util/request");var _utilRequest2=_interopRequireDefault(_utilRequest);var _error=require("./error");var _error2=_interopRequireDefault(_error);var _route=require("./route");var _route2=_interopRequireDefault(_route);var MIME_JSON=/\/(json|javascript)(\W|$)/;var Connection=function(){_createClass(Connection,null,[{key:"defaults",value:{url:"http://localhost:8529",databaseName:"_system",arangoVersion:20300},enumerable:true},{key:"agentDefaults",value:{maxSockets:3,keepAlive:true,keepAliveMsecs:1e3},enumerable:true}]);function Connection(config){_classCallCheck(this,Connection);if(typeof config==="string"){config={url:config}}this.config=(0,_extend2["default"])({},Connection.defaults,config);this.config.agentOptions=(0,_extend2["default"])({},Connection.agentDefaults,this.config.agentOptions);if(!this.config.headers)this.config.headers={};if(!this.config.headers["x-arango-version"]){this.config.headers["x-arango-version"]=this.config.arangoVersion}this._request=(0,_utilRequest2["default"])(this.config.url,this.config.agent,this.config.agentOptions);this.promisify=(0,_utilPromisify2["default"])(this.config.promise)}_createClass(Connection,[{key:"_resolveUrl",value:function _resolveUrl(opts){var url={pathname:""};if(!opts.absolutePath){url.pathname=url.pathname+"/_db/"+this.config.databaseName;if(opts.basePath)url.pathname=url.pathname+"/"+opts.basePath}url.pathname+=opts.path?(opts.path.charAt(0)==="/"?"":"/")+opts.path:"";if(opts.qs)url.search="?"+(typeof opts.qs==="string"?opts.qs:_querystring2["default"].stringify(opts.qs));return url}},{key:"route",value:function route(path){return new _route2["default"](this,path)}},{key:"request",value:function request(opts,cb){var _promisify=this.promisify(cb);var promise=_promisify.promise;var callback=_promisify.callback;var headers={"content-type":"text/plain"};if(!opts)opts={};var body=opts.body;if(body){if(typeof body==="object"){if(opts.ld){body=body.map(function(obj){return JSON.stringify(obj)}).join("\r\n")+"\r\n";headers["content-type"]="application/x-ldjson"}else{body=JSON.stringify(body);headers["content-type"]="application/json"}}else{body=String(body)}headers["content-length"]=Buffer.byteLength(body,"utf-8")}this._request({url:this._resolveUrl(opts),headers:(0,_extend2["default"])(headers,this.config.headers,opts.headers),method:(opts.method||"get").toUpperCase(),body:body},function(err,res){if(err)callback(err);else{res.rawBody=res.body;if(res.headers["content-type"].match(MIME_JSON)){try{res.body=JSON.parse(res.rawBody)}catch(e){return callback((0,_extend2["default"])(e,{response:res}))}}if(res.body&&res.body.error&&res.body.hasOwnProperty("code")&&res.body.hasOwnProperty("errorMessage")&&res.body.hasOwnProperty("errorNum")){callback((0,_extend2["default"])(new _error2["default"](res.body),{response:res}))}else if(res.statusCode>=400){callback((0,_extend2["default"])((0,_httpErrors2["default"])(res.statusCode),{response:res}))}else callback(null,res)}});return promise}}]);return Connection}();exports["default"]=Connection;module.exports=exports["default"]}).call(this,require("buffer").Buffer)},{"./error":6,"./route":9,"./util/promisify":12,"./util/request":13,buffer:15,extend:"extend","http-errors":54,querystring:27}],4:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var ArrayCursor=function(){function ArrayCursor(connection,body){_classCallCheck(this,ArrayCursor);this.extra=body.extra;this._connection=connection;this._api=this._connection.route("_api");this._result=body.result;this._hasMore=Boolean(body.hasMore);this._id=body.id;this._index=0;this.count=body.count}_createClass(ArrayCursor,[{key:"_drain",value:function _drain(cb){var _this=this;var _connection$promisify=this._connection.promisify(cb);var promise=_connection$promisify.promise;var callback=_connection$promisify.callback;this._more(function(err){return err?callback(err):!_this._hasMore?callback(null,_this):_this._drain(cb)});return promise}},{key:"_more",value:function _more(callback){var _this2=this;if(!this._hasMore)callback(null,this);else{this._api.put("cursor/"+this._id,function(err,res){if(err)callback(err);else{_this2._result.push.apply(_this2._result,res.body.result);_this2._hasMore=res.body.hasMore;callback(null,_this2)}})}}},{key:"all",value:function all(cb){var _this3=this;var _connection$promisify2=this._connection.promisify(cb);var promise=_connection$promisify2.promise;var callback=_connection$promisify2.callback;this._drain(function(err){_this3._index=_this3._result.length;if(err)callback(err);else callback(null,_this3._result)});return promise}},{key:"next",value:function next(cb){var _connection$promisify3=this._connection.promisify(cb);var promise=_connection$promisify3.promise;var callback=_connection$promisify3.callback;function next(){var value=this._result[this._index];this._index+=1;callback(null,value)}if(this._index<this._result.length)next();else{if(!this._hasMore)callback(null);else{this._more(function(err){return err?callback(err):next()})}}return promise}},{key:"hasNext",value:function hasNext(){return this._hasMore||this._index<this._result.length}},{key:"each",value:function each(fn,cb){var _this4=this;var _connection$promisify4=this._connection.promisify(cb);var promise=_connection$promisify4.promise;var callback=_connection$promisify4.callback;this._drain(function(err){if(err)callback(err);else{try{var result=true;for(_this4._index=0;_this4._index<_this4._result.length;_this4._index++){result=fn(_this4._result[_this4._index],_this4._index,_this4);if(result===false)break}callback(null)}catch(e){callback(e)}}});return promise}},{key:"every",value:function every(fn,cb){var _connection$promisify5=this._connection.promisify(cb);var promise=_connection$promisify5.promise;var callback=_connection$promisify5.callback;function loop(){try{var result=true;while(this._index<this._result.length){result=fn(this._result[this._index],this._index,this);this._index++;if(!result)break}if(!this._hasMore||!result)callback(null,result);else{this._more(function(err){return err?callback(err):loop()})}}catch(e){callback(e)}}this._index=0;loop();return promise}},{key:"some",value:function some(fn,cb){var _connection$promisify6=this._connection.promisify(cb);var promise=_connection$promisify6.promise;var callback=_connection$promisify6.callback;function loop(){try{var result=false;while(this._index<this._result.length){result=fn(this._result[this._index],this._index,this);this._index++;if(result)break}if(!this._hasMore||result)callback(null,result);else{this._more(function(err){return err?callback(err):loop()})}}catch(e){callback(e)}}this._index=0;loop();return promise}},{key:"map",value:function map(fn,cb){var _connection$promisify7=this._connection.promisify(cb);var promise=_connection$promisify7.promise;var callback=_connection$promisify7.callback;var result=[];function loop(x){try{while(this._index<this._result.length){
result.push(fn(this._result[this._index],this._index,this));this._index++}if(!this._hasMore)callback(null,result);else{this._more(function(err){return err?callback(err):loop()})}}catch(e){callback(e)}}this._index=0;loop();return promise}},{key:"reduce",value:function reduce(fn,accu,cb){var _this5=this;if(typeof accu==="function"){cb=accu;accu=undefined}var _connection$promisify8=this._connection.promisify(cb);var promise=_connection$promisify8.promise;var callback=_connection$promisify8.callback;function loop(){try{while(this._index<this._result.length){accu=fn(accu,this._result[this._index],this._index,this);this._index++}if(!this._hasMore)callback(null,accu);else{this._more(function(err){return err?callback(err):loop()})}}catch(e){callback(e)}}if(accu!==undefined){this._index=0;loop()}else if(this._result.length>1){accu=this._result[0];this._index=1;loop()}else{this._more(function(err){if(err)callback(err);else{accu=_this5._result[0];_this5._index=1;loop()}})}return promise}},{key:"rewind",value:function rewind(){this._index=0;return this}}]);return ArrayCursor}();exports["default"]=ArrayCursor;module.exports=exports["default"]},{}],5:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var _extend=require("extend");var _extend2=_interopRequireDefault(_extend);var _utilAll=require("./util/all");var _utilAll2=_interopRequireDefault(_utilAll);var _connection=require("./connection");var _connection2=_interopRequireDefault(_connection);var _cursor=require("./cursor");var _cursor2=_interopRequireDefault(_cursor);var _graph=require("./graph");var _graph2=_interopRequireDefault(_graph);var _collection=require("./collection");var _collection2=_interopRequireDefault(_collection);var Database=function(){function Database(config){_classCallCheck(this,Database);this._connection=new _connection2["default"](config);this._api=this._connection.route("_api");this.name=this._connection.config.databaseName}_createClass(Database,[{key:"route",value:function route(path,headers){return this._connection.route(path,headers)}},{key:"useDatabase",value:function useDatabase(databaseName){this._connection.config.databaseName=databaseName;this.name=databaseName}},{key:"get",value:function get(cb){var _connection$promisify=this._connection.promisify(cb);var promise=_connection$promisify.promise;var callback=_connection$promisify.callback;this._api.get("database/current",function(err,res){return err?callback(err):callback(null,res.body.result)});return promise}},{key:"createDatabase",value:function createDatabase(databaseName,users,cb){if(typeof users==="function"){cb=users;users=undefined}var _connection$promisify2=this._connection.promisify(cb);var promise=_connection$promisify2.promise;var callback=_connection$promisify2.callback;this._api.post("database",{users:users,name:databaseName},function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"listDatabases",value:function listDatabases(cb){var _connection$promisify3=this._connection.promisify(cb);var promise=_connection$promisify3.promise;var callback=_connection$promisify3.callback;this._api.get("database",function(err,res){return err?callback(err):callback(null,res.body.result)});return promise}},{key:"listUserDatabases",value:function listUserDatabases(cb){var _connection$promisify4=this._connection.promisify(cb);var promise=_connection$promisify4.promise;var callback=_connection$promisify4.callback;this._api.get("database/user",function(err,res){return err?callback(err):callback(null,res.body.result)});return promise}},{key:"dropDatabase",value:function dropDatabase(databaseName,cb){var _connection$promisify5=this._connection.promisify(cb);var promise=_connection$promisify5.promise;var callback=_connection$promisify5.callback;this._api["delete"]("database/"+databaseName,function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"collection",value:function collection(collectionName){return new _collection.DocumentCollection(this._connection,collectionName)}},{key:"edgeCollection",value:function edgeCollection(collectionName){return new _collection.EdgeCollection(this._connection,collectionName)}},{key:"listCollections",value:function listCollections(excludeSystem,cb){if(typeof excludeSystem==="function"){cb=excludeSystem;excludeSystem=undefined}var _connection$promisify6=this._connection.promisify(cb);var promise=_connection$promisify6.promise;var callback=_connection$promisify6.callback;if(typeof excludeSystem!=="boolean")excludeSystem=true;this._api.get("collection",{excludeSystem:excludeSystem},function(err,res){return err?callback(err):callback(null,res.body.collections)});return promise}},{key:"collections",value:function collections(excludeSystem,cb){var _this=this;var _connection$promisify7=this._connection.promisify(cb);var promise=_connection$promisify7.promise;var callback=_connection$promisify7.callback;this.listCollections(excludeSystem,function(err,collections){return err?callback(err):callback(collections.map(function(info){return(0,_collection2["default"])(_this._connection,info)}))});return promise}},{key:"truncate",value:function truncate(excludeSystem,cb){var _this2=this;if(typeof excludeSystem==="function"){cb=excludeSystem;excludeSystem=undefined}var _connection$promisify8=this._connection.promisify(cb);var promise=_connection$promisify8.promise;var callback=_connection$promisify8.callback;this.listCollections(excludeSystem,function(err,collections){return err?callback(err):(0,_utilAll2["default"])(collections.map(function(data){return function(cb){return _this2._api.put("collection/"+data.name+"/truncate",function(err,res){return err?cb(err):cb(null,res.body)})}}),callback)});return promise}},{key:"graph",value:function graph(graphName){return new _graph2["default"](this._connection,graphName)}},{key:"listGraphs",value:function listGraphs(cb){var _connection$promisify9=this._connection.promisify(cb);var promise=_connection$promisify9.promise;var callback=_connection$promisify9.callback;this._api.get("gharial",function(err,res){return err?callback(err):callback(res.body.graphs)});return promise}},{key:"graphs",value:function graphs(cb){var _this3=this;var _connection$promisify10=this._connection.promisify(cb);var promise=_connection$promisify10.promise;var callback=_connection$promisify10.callback;this.listGraphs(function(err,graphs){return err?callback(err):callback(graphs.map(function(info){return _this3.graph(info._key)}))});return promise}},{key:"transaction",value:function transaction(collections,action,params,lockTimeout,cb){if(typeof lockTimeout==="function"){cb=lockTimeout;lockTimeout=undefined}if(typeof params==="function"){cb=params;params=undefined}if(typeof params==="number"){lockTimeout=params;params=undefined}if(typeof collections==="string"||Array.isArray(collections)){collections={write:collections}}var _connection$promisify11=this._connection.promisify(cb);var promise=_connection$promisify11.promise;var callback=_connection$promisify11.callback;this._api.post("transaction",{collections:collections,action:action,params:params,lockTimeout:lockTimeout},function(err,res){return err?callback(err):callback(null,res.body.result)});return promise}},{key:"query",value:function query(_query,bindVars,opts,cb){var _this4=this;if(typeof opts==="function"){cb=opts;opts=undefined}if(typeof bindVars==="function"){cb=bindVars;bindVars=undefined}var _connection$promisify12=this._connection.promisify(cb);var promise=_connection$promisify12.promise;var callback=_connection$promisify12.callback;if(_query&&typeof _query.toAQL==="function"){_query=_query.toAQL()}if(_query&&_query.query){bindVars=_query.bindVars;_query=_query.query}this._api.post("cursor",(0,_extend2["default"])({},opts,{query:_query,bindVars:bindVars}),function(err,res){return err?callback(err):callback(null,new _cursor2["default"](_this4._connection,res.body))});return promise}},{key:"listFunctions",value:function listFunctions(cb){var _connection$promisify13=this._connection.promisify(cb);var promise=_connection$promisify13.promise;var callback=_connection$promisify13.callback;this._api.get("aqlfunction",function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"createFunction",value:function createFunction(name,code,cb){var _connection$promisify14=this._connection.promisify(cb);var promise=_connection$promisify14.promise;var callback=_connection$promisify14.callback;this._api.post("aqlfunction",{name:name,code:code},function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"dropFunction",value:function dropFunction(name,group,cb){if(typeof group==="function"){cb=group;group=undefined}var _connection$promisify15=this._connection.promisify(cb);var promise=_connection$promisify15.promise;var callback=_connection$promisify15.callback;this._api["delete"]("aqlfunction/"+name,{group:Boolean(group)},function(err,res){return err?callback(err):callback(null,res.body)});return promise}}]);return Database}();exports["default"]=Database;module.exports=exports["default"]},{"./collection":2,"./connection":3,"./cursor":4,"./graph":7,"./util/all":10,extend:"extend"}],6:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _get=function get(_x,_x2,_x3){var _again=true;_function:while(_again){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=undefined;_again=false;if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{_x=parent;_x2=property;_x3=receiver;_again=true;continue _function}}else if("value"in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}}};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var ArangoError=function(_Error){_inherits(ArangoError,_Error);function ArangoError(obj){_classCallCheck(this,ArangoError);_get(Object.getPrototypeOf(ArangoError.prototype),"constructor",this).call(this);this.name="ArangoError";this.message=obj.errorMessage;this.errorNum=obj.errorNum;this.code=obj.code;var err=new Error(this.message);err.name=this.name;if(err.fileName)this.fileName=err.fileName;if(err.lineNumber)this.lineNumber=err.lineNumber;if(err.columnNumber)this.columnNumber=err.columnNumber;if(err.stack)this.stack=err.stack;if(err.description)this.description=err.description;if(err.number)this.number=err.number}return ArangoError}(Error);exports["default"]=ArangoError;module.exports=exports["default"]},{}],7:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _get=function get(_x,_x2,_x3){var _again=true;_function:while(_again){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=undefined;_again=false;if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{_x=parent;_x2=property;_x3=receiver;_again=true;continue _function}}else if("value"in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}}};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _extend=require("extend");var _extend2=_interopRequireDefault(_extend);var _collection=require("./collection");var GraphVertexCollection=function(_BaseCollection){_inherits(GraphVertexCollection,_BaseCollection);function GraphVertexCollection(connection,name,graph){_classCallCheck(this,GraphVertexCollection);_get(Object.getPrototypeOf(GraphVertexCollection.prototype),"constructor",this).call(this,connection,name);this.graph=graph;this._gharial=this._api.route("gharial/"+this.graph.name+"/vertex/"+this.name)}_createClass(GraphVertexCollection,[{key:"vertex",value:function vertex(documentHandle,cb){var _connection$promisify=this._connection.promisify(cb);var promise=_connection$promisify.promise;var callback=_connection$promisify.callback;this._gharial.get(documentHandle,function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"save",value:function save(data,cb){var _connection$promisify2=this._connection.promisify(cb);var promise=_connection$promisify2.promise;var callback=_connection$promisify2.callback;this._gharial.post(data,{collection:this.name},function(err,res){return err?callback(err):callback(null,res.body)});return promise}}]);return GraphVertexCollection}(_collection._BaseCollection);var GraphEdgeCollection=function(_BaseCollection2){_inherits(GraphEdgeCollection,_BaseCollection2);function GraphEdgeCollection(connection,name,graph){_classCallCheck(this,GraphEdgeCollection);_get(Object.getPrototypeOf(GraphEdgeCollection.prototype),"constructor",this).call(this,connection,name);this.graph=graph;this._gharial=this._api.route("gharial/"+this.graph.name+"/edge/"+this.name)}_createClass(GraphEdgeCollection,[{key:"edge",value:function edge(documentHandle,cb){var _connection$promisify3=this._connection.promisify(cb);var promise=_connection$promisify3.promise;var callback=_connection$promisify3.callback;this._gharial.get(documentHandle,function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"save",value:function save(data,fromId,toId,cb){if(typeof fromId==="function"){cb=fromId;fromId=undefined}else{data._from=this._documentHandle(fromId);data._to=this._documentHandle(toId)}var _connection$promisify4=this._connection.promisify(cb);var promise=_connection$promisify4.promise;var callback=_connection$promisify4.callback;this._gharial.post(data,function(err,res){return err?callback(err):callback(null,res.body)});return promise}}]);return GraphEdgeCollection}(_collection._BaseCollection);var Graph=function(){function Graph(connection,name){_classCallCheck(this,Graph);this._connection=connection;this._api=this._connection.route("_api");this._gharial=this._api.route("gharial/"+this.name);this.name=name}_createClass(Graph,[{key:"get",value:function get(cb){var _connection$promisify5=this._connection.promisify(cb);var promise=_connection$promisify5.promise;var callback=_connection$promisify5.callback;this._gharial.get(function(err,res){return err?callback(err):callback(null,res.body.graph)});return promise}},{key:"create",value:function create(properties,cb){if(typeof properties==="function"){cb=properties;properties=undefined}var _connection$promisify6=this._connection.promisify(cb);var promise=_connection$promisify6.promise;var callback=_connection$promisify6.callback;this._api.post("gharial",(0,_extend2["default"])({},properties,{name:this.name}),function(err,res){return err?callback(err):callback(null,res.body.graph)});return promise}},{key:"drop",value:function drop(dropCollections,cb){if(typeof dropCollections==="function"){cb=dropCollections;dropCollections=undefined}var _connection$promisify7=this._connection.promisify(cb);var promise=_connection$promisify7.promise;var callback=_connection$promisify7.callback;this._gharial["delete"]({dropCollections:dropCollections},function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"vertexCollection",value:function vertexCollection(collectionName){return new GraphVertexCollection(this._connection,collectionName,this)}},{key:"addVertexCollection",value:function addVertexCollection(collectionName,cb){var _connection$promisify8=this._connection.promisify(cb);var promise=_connection$promisify8.promise;var callback=_connection$promisify8.callback;this._gharial.post("vertex",{collection:collectionName},function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"removeVertexCollection",value:function removeVertexCollection(collectionName,dropCollection,cb){if(typeof dropCollection==="function"){cb=dropCollection;dropCollection=undefined}var _connection$promisify9=this._connection.promisify(cb);var promise=_connection$promisify9.promise;var callback=_connection$promisify9.callback;this._gharial["delete"]("vertex/"+collectionName,{dropCollection:dropCollection},function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"edgeCollection",value:function edgeCollection(collectionName){return new GraphEdgeCollection(this._connection,collectionName,this)}},{key:"addEdgeDefinition",value:function addEdgeDefinition(definition,cb){var _connection$promisify10=this._connection.promisify(cb);var promise=_connection$promisify10.promise;var callback=_connection$promisify10.callback;this._gharial.post("edge",definition,function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"replaceEdgeDefinition",value:function replaceEdgeDefinition(definitionName,definition,cb){var _connection$promisify11=this._connection.promisify(cb);var promise=_connection$promisify11.promise;var callback=_connection$promisify11.callback;this._api.put("gharial/"+this.name+"/edge/"+definitionName,definition,function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"removeEdgeDefinition",value:function removeEdgeDefinition(definitionName,dropCollection,cb){if(typeof dropCollection==="function"){cb=dropCollection;dropCollection=undefined}var _connection$promisify12=this._connection.promisify(cb);var promise=_connection$promisify12.promise;var callback=_connection$promisify12.callback;this._gharial["delete"]("edge/"+definitionName,{dropCollection:dropCollection},function(err,res){return err?callback(err):callback(null,res.body)});return promise}},{key:"traversal",value:function traversal(startVertex,opts,cb){if(typeof opts==="function"){cb=opts;opts=undefined}var _connection$promisify13=this._connection.promisify(cb);var promise=_connection$promisify13.promise;var callback=_connection$promisify13.callback;this._api.post("traversal",(0,_extend2["default"])({},opts,{startVertex:startVertex,graphName:this.name}),function(err,res){return err?callback(err):callback(null,res.body.result)});return promise}}]);return Graph}();exports["default"]=Graph;exports.VertexCollection=GraphVertexCollection;exports.EdgeCollection=GraphEdgeCollection},{"./collection":2,extend:"extend"}],8:[function(require,module,exports){"use strict";var _bind=Function.prototype.bind;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _extend=require("extend");var _extend2=_interopRequireDefault(_extend);var _database=require("./database");var _database2=_interopRequireDefault(_database);var _aqlQuery=require("./aql-query");var _aqlQuery2=_interopRequireDefault(_aqlQuery);module.exports=(0,_extend2["default"])(function(){for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return new(_bind.apply(_database2["default"],[null].concat(args)))},{Database:_database2["default"],aqlQuery:_aqlQuery2["default"]})},{"./aql-query":1,"./database":5,extend:"extend"}],9:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var _extend=require("extend");var _extend2=_interopRequireDefault(_extend);var Route=function(){function Route(connection,path,headers){_classCallCheck(this,Route);this._connection=connection;this._path=path||"";this._headers=headers}_createClass(Route,[{key:"route",value:function route(path,headers){if(!path)path="";else if(path.charAt(0)!=="/")path="/"+path;return new Route(this._connection,this._path+path,(0,_extend2["default"])({},this._headers,headers))}},{key:"request",value:function request(opts,callback){opts=(0,_extend2["default"])({},opts);opts.basePath=this._path;opts.headers=(0,_extend2["default"])({},this._headers,opts.headers);return this._connection.request(opts,callback)}},{key:"get",value:function get(path,qs,callback){if(typeof path!=="string"){callback=qs;qs=path;path=undefined}if(typeof qs==="function"){callback=qs;qs=undefined}if(!path)path="";else if(this._path&&path.charAt(0)!=="/")path="/"+path;return this.request({path:path,qs:qs,method:"get"},callback)}},{key:"post",value:function post(path,body,qs,callback){if(typeof path!=="string"){callback=qs;qs=body;body=path;path=undefined}if(typeof qs==="function"){callback=qs;qs=undefined}if(typeof body==="function"){callback=body;body=undefined}if(!path)path="";else if(this._path&&path.charAt(0)!=="/")path="/"+path;return this.request({path:path,body:body,qs:qs,method:"post"},callback)}},{key:"put",value:function put(path,body,qs,callback){if(typeof path!=="string"){callback=body;body=qs;qs=path;path=undefined}if(typeof qs==="function"){callback=qs;qs=undefined}if(typeof body==="function"){callback=body;body=undefined}if(!path)path="";else if(this._path&&path.charAt(0)!=="/")path="/"+path;return this.request({path:path,body:body,qs:qs,method:"put"},callback)}},{key:"patch",value:function patch(path,body,qs,callback){if(typeof path!=="string"){callback=body;body=qs;qs=path;path=undefined}if(typeof qs==="function"){callback=qs;qs=undefined}if(typeof body==="function"){callback=body;body=undefined}if(!path)path="";else if(this._path&&path.charAt(0)!=="/")path="/"+path;return this.request({path:path,body:body,qs:qs,method:"patch"},callback)}},{key:"delete",value:function _delete(path,qs,callback){if(typeof path!=="string"){callback=qs;qs=path;path=undefined}if(typeof qs==="function"){callback=qs;qs=undefined}if(!path)path="";else if(this._path&&path.charAt(0)!=="/")path="/"+path;return this.request({path:path,qs:qs,method:"delete"},callback)}},{key:"head",value:function head(path,qs,callback){if(typeof path!=="string"){callback=qs;qs=path;path=undefined}if(typeof qs==="function"){callback=qs;qs=undefined}if(!path)path="";else if(this._path&&path.charAt(0)!=="/")path="/"+path;return this.request({path:path,qs:qs,method:"head"},callback)}}]);return Route}();exports["default"]=Route;module.exports=exports["default"]},{extend:"extend"}],10:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=all;function all(arr,callback){var result=[];var pending=arr.length;var called=false;if(arr.length===0)return callback(null,result);function step(i){return function(err,res){pending-=1;if(!err)result[i]=res;if(!called){if(err)callback(err);else if(pending===0){if(result.every(function(r){return r===undefined}))callback(null);else callback(null,result)}else return;called=true}}}arr.forEach(function(fn,i){return fn(step(i))})}module.exports=exports["default"]},{}],11:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=once;function once(cb){var called=false;return function(){if(called)return;called=true;return cb.apply(undefined,arguments)}}module.exports=exports["default"]},{}],12:[function(require,module,exports){(function(global){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=promisify;function promisify(Promise){if(Promise===false){return function(){var callback=arguments.length<=0||arguments[0]===undefined?function(){return undefined}:arguments[0];return{callback:callback}}}return function(){var callback=arguments.length<=0||arguments[0]===undefined?function(){return undefined}:arguments[0];if(!Promise&&!global.Promise){return{callback:callback}}function defer(resolve,reject){var errback=callback;callback=function(err,res){if(err)reject(err);else resolve(res);if(errback)errback(err,res)}}var promise=Promise?new Promise(defer):new global.Promise(defer);return{callback:callback,promise:promise}}}module.exports=exports["default"]}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],13:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _http=require("http");var _http2=_interopRequireDefault(_http);var _https=require("https");var _https2=_interopRequireDefault(_https);var _url=require("url");var _once=require("./once");var _once2=_interopRequireDefault(_once);var _linkedlist=require("linkedlist");var _linkedlist2=_interopRequireDefault(_linkedlist);function joinPath(){var a=arguments.length<=0||arguments[0]===undefined?"":arguments[0];var b=arguments.length<=1||arguments[1]===undefined?"":arguments[1];if(!a&&!b)return"";var leadingSlash=a.charAt(0)==="/";var trailingSlash=b.charAt(b.length-1)==="/";var tokens=(a+"/"+b).split("/").filter(Boolean);for(var i=0;i<tokens.length;i++){var token=tokens[i];if(token===".."){tokens.splice(i-1,2);i--}else if(token==="."){tokens.splice(i,1);i--}}var path=tokens.join("/");if(leadingSlash)path="/"+path;if(trailingSlash)path=path+"/";return path}function rawCopy(obj){var result={};for(var key in obj){if(obj.hasOwnProperty(key)){result[key]=obj[key]}}return result}exports["default"]=function(baseUrl,agent,agentOptions){var baseUrlParts=rawCopy((0,_url.parse)(baseUrl));var isTls=baseUrlParts.protocol==="https:";if(!agent){var Agent=(isTls?_https2["default"]:_http2["default"]).Agent;agent=new Agent(agentOptions)}var queue=new _linkedlist2["default"];var maxTasks=typeof agent.maxSockets==="number"?agent.maxSockets*2:Infinity;var activeTasks=0;function drainQueue(){if(!queue.length||activeTasks>=maxTasks)return;var task=queue.shift();activeTasks+=1;task(function(){activeTasks-=1;drainQueue()})}return function request(_ref,cb){var method=_ref.method;var url=_ref.url;var headers=_ref.headers;var body=_ref.body;var path=baseUrlParts.pathname?url.pathname?joinPath(baseUrlParts.pathname,url.pathname):baseUrlParts.pathname:url.pathname;var search=url.search?baseUrlParts.search?baseUrlParts.search+"&"+url.search.slice(1):url.search:baseUrlParts.search;if(search)path+=search;var options={path:path,method:method,headers:headers,agent:agent};options.hostname=baseUrlParts.hostname;options.port=baseUrlParts.port;options.auth=baseUrlParts.auth;queue.push(function(next){var _this=this;var callback=(0,_once2["default"])(function(){for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}next();cb.apply(_this,args)});var req=(isTls?_https2["default"]:_http2["default"]).request(options,function(res){var data=[];res.on("data",function(chunk){return data.push(chunk)}).on("end",function(){res.body=data.join("");callback(null,res)})});req.on("error",function(err){err.request=req;callback(err)});if(body)req.write(body);req.end()});drainQueue()}};module.exports=exports["default"]},{"./once":11,http:42,https:20,linkedlist:58,url:52}],14:[function(require,module,exports){},{}],15:[function(require,module,exports){var base64=require("base64-js");var ieee754=require("ieee754");var isArray=require("is-array");exports.Buffer=Buffer;exports.SlowBuffer=SlowBuffer;exports.INSPECT_MAX_BYTES=50;Buffer.poolSize=8192;var rootParent={};Buffer.TYPED_ARRAY_SUPPORT=function(){function Bar(){}try{var arr=new Uint8Array(1);arr.foo=function(){return 42};arr.constructor=Bar;return arr.foo()===42&&arr.constructor===Bar&&typeof arr.subarray==="function"&&arr.subarray(1,1).byteLength===0}catch(e){return false}}();function kMaxLength(){return Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function Buffer(arg){if(!(this instanceof Buffer)){if(arguments.length>1)return new Buffer(arg,arguments[1]);return new Buffer(arg)}this.length=0;this.parent=undefined;if(typeof arg==="number"){return fromNumber(this,arg)}if(typeof arg==="string"){return fromString(this,arg,arguments.length>1?arguments[1]:"utf8")}return fromObject(this,arg)}function fromNumber(that,length){that=allocate(that,length<0?0:checked(length)|0);if(!Buffer.TYPED_ARRAY_SUPPORT){for(var i=0;i<length;i++){that[i]=0}}return that}function fromString(that,string,encoding){if(typeof encoding!=="string"||encoding==="")encoding="utf8";var length=byteLength(string,encoding)|0;that=allocate(that,length);that.write(string,encoding);return that}function fromObject(that,object){if(Buffer.isBuffer(object))return fromBuffer(that,object);if(isArray(object))return fromArray(that,object);if(object==null){throw new TypeError("must start with number, buffer, array or string")}if(typeof ArrayBuffer!=="undefined"){if(object.buffer instanceof ArrayBuffer){return fromTypedArray(that,object)}if(object instanceof ArrayBuffer){return fromArrayBuffer(that,object)}}if(object.length)return fromArrayLike(that,object);return fromJsonObject(that,object)}function fromBuffer(that,buffer){var length=checked(buffer.length)|0;that=allocate(that,length);buffer.copy(that,0,0,length);return that}function fromArray(that,array){var length=checked(array.length)|0;that=allocate(that,length);for(var i=0;i<length;i+=1){that[i]=array[i]&255}return that;
}function fromTypedArray(that,array){var length=checked(array.length)|0;that=allocate(that,length);for(var i=0;i<length;i+=1){that[i]=array[i]&255}return that}function fromArrayBuffer(that,array){if(Buffer.TYPED_ARRAY_SUPPORT){array.byteLength;that=Buffer._augment(new Uint8Array(array))}else{that=fromTypedArray(that,new Uint8Array(array))}return that}function fromArrayLike(that,array){var length=checked(array.length)|0;that=allocate(that,length);for(var i=0;i<length;i+=1){that[i]=array[i]&255}return that}function fromJsonObject(that,object){var array;var length=0;if(object.type==="Buffer"&&isArray(object.data)){array=object.data;length=checked(array.length)|0}that=allocate(that,length);for(var i=0;i<length;i+=1){that[i]=array[i]&255}return that}function allocate(that,length){if(Buffer.TYPED_ARRAY_SUPPORT){that=Buffer._augment(new Uint8Array(length))}else{that.length=length;that._isBuffer=true}var fromPool=length!==0&&length<=Buffer.poolSize>>>1;if(fromPool)that.parent=rootParent;return that}function checked(length){if(length>=kMaxLength()){throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+kMaxLength().toString(16)+" bytes")}return length|0}function SlowBuffer(subject,encoding){if(!(this instanceof SlowBuffer))return new SlowBuffer(subject,encoding);var buf=new Buffer(subject,encoding);delete buf.parent;return buf}Buffer.isBuffer=function isBuffer(b){return!!(b!=null&&b._isBuffer)};Buffer.compare=function compare(a,b){if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b)){throw new TypeError("Arguments must be Buffers")}if(a===b)return 0;var x=a.length;var y=b.length;var i=0;var len=Math.min(x,y);while(i<len){if(a[i]!==b[i])break;++i}if(i!==len){x=a[i];y=b[i]}if(x<y)return-1;if(y<x)return 1;return 0};Buffer.isEncoding=function isEncoding(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};Buffer.concat=function concat(list,length){if(!isArray(list))throw new TypeError("list argument must be an Array of Buffers.");if(list.length===0){return new Buffer(0)}var i;if(length===undefined){length=0;for(i=0;i<list.length;i++){length+=list[i].length}}var buf=new Buffer(length);var pos=0;for(i=0;i<list.length;i++){var item=list[i];item.copy(buf,pos);pos+=item.length}return buf};function byteLength(string,encoding){if(typeof string!=="string")string=""+string;var len=string.length;if(len===0)return 0;var loweredCase=false;for(;;){switch(encoding){case"ascii":case"binary":case"raw":case"raws":return len;case"utf8":case"utf-8":return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return len*2;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase)return utf8ToBytes(string).length;encoding=(""+encoding).toLowerCase();loweredCase=true}}}Buffer.byteLength=byteLength;Buffer.prototype.length=undefined;Buffer.prototype.parent=undefined;function slowToString(encoding,start,end){var loweredCase=false;start=start|0;end=end===undefined||end===Infinity?this.length:end|0;if(!encoding)encoding="utf8";if(start<0)start=0;if(end>this.length)end=this.length;if(end<=start)return"";while(true){switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"binary":return binarySlice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase();loweredCase=true}}}Buffer.prototype.toString=function toString(){var length=this.length|0;if(length===0)return"";if(arguments.length===0)return utf8Slice(this,0,length);return slowToString.apply(this,arguments)};Buffer.prototype.equals=function equals(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");if(this===b)return true;return Buffer.compare(this,b)===0};Buffer.prototype.inspect=function inspect(){var str="";var max=exports.INSPECT_MAX_BYTES;if(this.length>0){str=this.toString("hex",0,max).match(/.{2}/g).join(" ");if(this.length>max)str+=" ... "}return"<Buffer "+str+">"};Buffer.prototype.compare=function compare(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");if(this===b)return 0;return Buffer.compare(this,b)};Buffer.prototype.indexOf=function indexOf(val,byteOffset){if(byteOffset>2147483647)byteOffset=2147483647;else if(byteOffset<-2147483648)byteOffset=-2147483648;byteOffset>>=0;if(this.length===0)return-1;if(byteOffset>=this.length)return-1;if(byteOffset<0)byteOffset=Math.max(this.length+byteOffset,0);if(typeof val==="string"){if(val.length===0)return-1;return String.prototype.indexOf.call(this,val,byteOffset)}if(Buffer.isBuffer(val)){return arrayIndexOf(this,val,byteOffset)}if(typeof val==="number"){if(Buffer.TYPED_ARRAY_SUPPORT&&Uint8Array.prototype.indexOf==="function"){return Uint8Array.prototype.indexOf.call(this,val,byteOffset)}return arrayIndexOf(this,[val],byteOffset)}function arrayIndexOf(arr,val,byteOffset){var foundIndex=-1;for(var i=0;byteOffset+i<arr.length;i++){if(arr[byteOffset+i]===val[foundIndex===-1?0:i-foundIndex]){if(foundIndex===-1)foundIndex=i;if(i-foundIndex+1===val.length)return byteOffset+foundIndex}else{foundIndex=-1}}return-1}throw new TypeError("val must be string, number or Buffer")};Buffer.prototype.get=function get(offset){console.log(".get() is deprecated. Access using array indexes instead.");return this.readUInt8(offset)};Buffer.prototype.set=function set(v,offset){console.log(".set() is deprecated. Access using array indexes instead.");return this.writeUInt8(v,offset)};function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;if(!length){length=remaining}else{length=Number(length);if(length>remaining){length=remaining}}var strLen=string.length;if(strLen%2!==0)throw new Error("Invalid hex string");if(length>strLen/2){length=strLen/2}for(var i=0;i<length;i++){var parsed=parseInt(string.substr(i*2,2),16);if(isNaN(parsed))throw new Error("Invalid hex string");buf[offset+i]=parsed}return i}function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}function asciiWrite(buf,string,offset,length){return blitBuffer(asciiToBytes(string),buf,offset,length)}function binaryWrite(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(utf16leToBytes(string,buf.length-offset),buf,offset,length)}Buffer.prototype.write=function write(string,offset,length,encoding){if(offset===undefined){encoding="utf8";length=this.length;offset=0}else if(length===undefined&&typeof offset==="string"){encoding=offset;length=this.length;offset=0}else if(isFinite(offset)){offset=offset|0;if(isFinite(length)){length=length|0;if(encoding===undefined)encoding="utf8"}else{encoding=length;length=undefined}}else{var swap=encoding;encoding=offset;offset=length|0;length=swap}var remaining=this.length-offset;if(length===undefined||length>remaining)length=remaining;if(string.length>0&&(length<0||offset<0)||offset>this.length){throw new RangeError("attempt to write outside buffer bounds")}if(!encoding)encoding="utf8";var loweredCase=false;for(;;){switch(encoding){case"hex":return hexWrite(this,string,offset,length);case"utf8":case"utf-8":return utf8Write(this,string,offset,length);case"ascii":return asciiWrite(this,string,offset,length);case"binary":return binaryWrite(this,string,offset,length);case"base64":return base64Write(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase();loweredCase=true}}};Buffer.prototype.toJSON=function toJSON(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function base64Slice(buf,start,end){if(start===0&&end===buf.length){return base64.fromByteArray(buf)}else{return base64.fromByteArray(buf.slice(start,end))}}function utf8Slice(buf,start,end){var res="";var tmp="";end=Math.min(buf.length,end);for(var i=start;i<end;i++){if(buf[i]<=127){res+=decodeUtf8Char(tmp)+String.fromCharCode(buf[i]);tmp=""}else{tmp+="%"+buf[i].toString(16)}}return res+decodeUtf8Char(tmp)}function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;i++){ret+=String.fromCharCode(buf[i]&127)}return ret}function binarySlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;i++){ret+=String.fromCharCode(buf[i])}return ret}function hexSlice(buf,start,end){var len=buf.length;if(!start||start<0)start=0;if(!end||end<0||end>len)end=len;var out="";for(var i=start;i<end;i++){out+=toHex(buf[i])}return out}function utf16leSlice(buf,start,end){var bytes=buf.slice(start,end);var res="";for(var i=0;i<bytes.length;i+=2){res+=String.fromCharCode(bytes[i]+bytes[i+1]*256)}return res}Buffer.prototype.slice=function slice(start,end){var len=this.length;start=~~start;end=end===undefined?len:~~end;if(start<0){start+=len;if(start<0)start=0}else if(start>len){start=len}if(end<0){end+=len;if(end<0)end=0}else if(end>len){end=len}if(end<start)end=start;var newBuf;if(Buffer.TYPED_ARRAY_SUPPORT){newBuf=Buffer._augment(this.subarray(start,end))}else{var sliceLen=end-start;newBuf=new Buffer(sliceLen,undefined);for(var i=0;i<sliceLen;i++){newBuf[i]=this[i+start]}}if(newBuf.length)newBuf.parent=this.parent||this;return newBuf};function checkOffset(offset,ext,length){if(offset%1!==0||offset<0)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length")}Buffer.prototype.readUIntLE=function readUIntLE(offset,byteLength,noAssert){offset=offset|0;byteLength=byteLength|0;if(!noAssert)checkOffset(offset,byteLength,this.length);var val=this[offset];var mul=1;var i=0;while(++i<byteLength&&(mul*=256)){val+=this[offset+i]*mul}return val};Buffer.prototype.readUIntBE=function readUIntBE(offset,byteLength,noAssert){offset=offset|0;byteLength=byteLength|0;if(!noAssert){checkOffset(offset,byteLength,this.length)}var val=this[offset+--byteLength];var mul=1;while(byteLength>0&&(mul*=256)){val+=this[offset+--byteLength]*mul}return val};Buffer.prototype.readUInt8=function readUInt8(offset,noAssert){if(!noAssert)checkOffset(offset,1,this.length);return this[offset]};Buffer.prototype.readUInt16LE=function readUInt16LE(offset,noAssert){if(!noAssert)checkOffset(offset,2,this.length);return this[offset]|this[offset+1]<<8};Buffer.prototype.readUInt16BE=function readUInt16BE(offset,noAssert){if(!noAssert)checkOffset(offset,2,this.length);return this[offset]<<8|this[offset+1]};Buffer.prototype.readUInt32LE=function readUInt32LE(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length);return(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+this[offset+3]*16777216};Buffer.prototype.readUInt32BE=function readUInt32BE(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length);return this[offset]*16777216+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])};Buffer.prototype.readIntLE=function readIntLE(offset,byteLength,noAssert){offset=offset|0;byteLength=byteLength|0;if(!noAssert)checkOffset(offset,byteLength,this.length);var val=this[offset];var mul=1;var i=0;while(++i<byteLength&&(mul*=256)){val+=this[offset+i]*mul}mul*=128;if(val>=mul)val-=Math.pow(2,8*byteLength);return val};Buffer.prototype.readIntBE=function readIntBE(offset,byteLength,noAssert){offset=offset|0;byteLength=byteLength|0;if(!noAssert)checkOffset(offset,byteLength,this.length);var i=byteLength;var mul=1;var val=this[offset+--i];while(i>0&&(mul*=256)){val+=this[offset+--i]*mul}mul*=128;if(val>=mul)val-=Math.pow(2,8*byteLength);return val};Buffer.prototype.readInt8=function readInt8(offset,noAssert){if(!noAssert)checkOffset(offset,1,this.length);if(!(this[offset]&128))return this[offset];return(255-this[offset]+1)*-1};Buffer.prototype.readInt16LE=function readInt16LE(offset,noAssert){if(!noAssert)checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return val&32768?val|4294901760:val};Buffer.prototype.readInt16BE=function readInt16BE(offset,noAssert){if(!noAssert)checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return val&32768?val|4294901760:val};Buffer.prototype.readInt32LE=function readInt32LE(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length);return this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24};Buffer.prototype.readInt32BE=function readInt32BE(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length);return this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]};Buffer.prototype.readFloatLE=function readFloatLE(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length);return ieee754.read(this,offset,true,23,4)};Buffer.prototype.readFloatBE=function readFloatBE(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length);return ieee754.read(this,offset,false,23,4)};Buffer.prototype.readDoubleLE=function readDoubleLE(offset,noAssert){if(!noAssert)checkOffset(offset,8,this.length);return ieee754.read(this,offset,true,52,8)};Buffer.prototype.readDoubleBE=function readDoubleBE(offset,noAssert){if(!noAssert)checkOffset(offset,8,this.length);return ieee754.read(this,offset,false,52,8)};function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError("buffer must be a Buffer instance");if(value>max||value<min)throw new RangeError("value is out of bounds");if(offset+ext>buf.length)throw new RangeError("index out of range")}Buffer.prototype.writeUIntLE=function writeUIntLE(value,offset,byteLength,noAssert){value=+value;offset=offset|0;byteLength=byteLength|0;if(!noAssert)checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength),0);var mul=1;var i=0;this[offset]=value&255;while(++i<byteLength&&(mul*=256)){this[offset+i]=value/mul&255}return offset+byteLength};Buffer.prototype.writeUIntBE=function writeUIntBE(value,offset,byteLength,noAssert){value=+value;offset=offset|0;byteLength=byteLength|0;if(!noAssert)checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength),0);var i=byteLength-1;var mul=1;this[offset+i]=value&255;while(--i>=0&&(mul*=256)){this[offset+i]=value/mul&255}return offset+byteLength};Buffer.prototype.writeUInt8=function writeUInt8(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,1,255,0);if(!Buffer.TYPED_ARRAY_SUPPORT)value=Math.floor(value);this[offset]=value;return offset+1};function objectWriteUInt16(buf,value,offset,littleEndian){if(value<0)value=65535+value+1;for(var i=0,j=Math.min(buf.length-offset,2);i<j;i++){buf[offset+i]=(value&255<<8*(littleEndian?i:1-i))>>>(littleEndian?i:1-i)*8}}Buffer.prototype.writeUInt16LE=function writeUInt16LE(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,2,65535,0);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value;this[offset+1]=value>>>8}else{objectWriteUInt16(this,value,offset,true)}return offset+2};Buffer.prototype.writeUInt16BE=function writeUInt16BE(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,2,65535,0);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value>>>8;this[offset+1]=value}else{objectWriteUInt16(this,value,offset,false)}return offset+2};function objectWriteUInt32(buf,value,offset,littleEndian){if(value<0)value=4294967295+value+1;for(var i=0,j=Math.min(buf.length-offset,4);i<j;i++){buf[offset+i]=value>>>(littleEndian?i:3-i)*8&255}}Buffer.prototype.writeUInt32LE=function writeUInt32LE(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,4,4294967295,0);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset+3]=value>>>24;this[offset+2]=value>>>16;this[offset+1]=value>>>8;this[offset]=value}else{objectWriteUInt32(this,value,offset,true)}return offset+4};Buffer.prototype.writeUInt32BE=function writeUInt32BE(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,4,4294967295,0);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value>>>24;this[offset+1]=value>>>16;this[offset+2]=value>>>8;this[offset+3]=value}else{objectWriteUInt32(this,value,offset,false)}return offset+4};Buffer.prototype.writeIntLE=function writeIntLE(value,offset,byteLength,noAssert){value=+value;offset=offset|0;if(!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=0;var mul=1;var sub=value<0?1:0;this[offset]=value&255;while(++i<byteLength&&(mul*=256)){this[offset+i]=(value/mul>>0)-sub&255}return offset+byteLength};Buffer.prototype.writeIntBE=function writeIntBE(value,offset,byteLength,noAssert){value=+value;offset=offset|0;if(!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=byteLength-1;var mul=1;var sub=value<0?1:0;this[offset+i]=value&255;while(--i>=0&&(mul*=256)){this[offset+i]=(value/mul>>0)-sub&255}return offset+byteLength};Buffer.prototype.writeInt8=function writeInt8(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,1,127,-128);if(!Buffer.TYPED_ARRAY_SUPPORT)value=Math.floor(value);if(value<0)value=255+value+1;this[offset]=value;return offset+1};Buffer.prototype.writeInt16LE=function writeInt16LE(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,2,32767,-32768);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value;this[offset+1]=value>>>8}else{objectWriteUInt16(this,value,offset,true)}return offset+2};Buffer.prototype.writeInt16BE=function writeInt16BE(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,2,32767,-32768);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value>>>8;this[offset+1]=value}else{objectWriteUInt16(this,value,offset,false)}return offset+2};Buffer.prototype.writeInt32LE=function writeInt32LE(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,4,2147483647,-2147483648);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value;this[offset+1]=value>>>8;this[offset+2]=value>>>16;this[offset+3]=value>>>24}else{objectWriteUInt32(this,value,offset,true)}return offset+4};Buffer.prototype.writeInt32BE=function writeInt32BE(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,4,2147483647,-2147483648);if(value<0)value=4294967295+value+1;if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value>>>24;this[offset+1]=value>>>16;this[offset+2]=value>>>8;this[offset+3]=value}else{objectWriteUInt32(this,value,offset,false)}return offset+4};function checkIEEE754(buf,value,offset,ext,max,min){if(value>max||value<min)throw new RangeError("value is out of bounds");if(offset+ext>buf.length)throw new RangeError("index out of range");if(offset<0)throw new RangeError("index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){if(!noAssert){checkIEEE754(buf,value,offset,4,3.4028234663852886e38,-3.4028234663852886e38)}ieee754.write(buf,value,offset,littleEndian,23,4);return offset+4}Buffer.prototype.writeFloatLE=function writeFloatLE(value,offset,noAssert){return writeFloat(this,value,offset,true,noAssert)};Buffer.prototype.writeFloatBE=function writeFloatBE(value,offset,noAssert){return writeFloat(this,value,offset,false,noAssert)};function writeDouble(buf,value,offset,littleEndian,noAssert){if(!noAssert){checkIEEE754(buf,value,offset,8,1.7976931348623157e308,-1.7976931348623157e308)}ieee754.write(buf,value,offset,littleEndian,52,8);return offset+8}Buffer.prototype.writeDoubleLE=function writeDoubleLE(value,offset,noAssert){return writeDouble(this,value,offset,true,noAssert)};Buffer.prototype.writeDoubleBE=function writeDoubleBE(value,offset,noAssert){return writeDouble(this,value,offset,false,noAssert)};Buffer.prototype.copy=function copy(target,targetStart,start,end){if(!start)start=0;if(!end&&end!==0)end=this.length;if(targetStart>=target.length)targetStart=target.length;if(!targetStart)targetStart=0;if(end>0&&end<start)end=start;if(end===start)return 0;if(target.length===0||this.length===0)return 0;if(targetStart<0){throw new RangeError("targetStart out of bounds")}if(start<0||start>=this.length)throw new RangeError("sourceStart out of bounds");if(end<0)throw new RangeError("sourceEnd out of bounds");if(end>this.length)end=this.length;if(target.length-targetStart<end-start){end=target.length-targetStart+start}var len=end-start;if(len<1e3||!Buffer.TYPED_ARRAY_SUPPORT){for(var i=0;i<len;i++){target[i+targetStart]=this[i+start]}}else{target._set(this.subarray(start,start+len),targetStart)}return len};Buffer.prototype.fill=function fill(value,start,end){if(!value)value=0;if(!start)start=0;if(!end)end=this.length;if(end<start)throw new RangeError("end < start");if(end===start)return;if(this.length===0)return;if(start<0||start>=this.length)throw new RangeError("start out of bounds");if(end<0||end>this.length)throw new RangeError("end out of bounds");var i;if(typeof value==="number"){for(i=start;i<end;i++){this[i]=value}}else{var bytes=utf8ToBytes(value.toString());var len=bytes.length;for(i=start;i<end;i++){this[i]=bytes[i%len]}}return this};Buffer.prototype.toArrayBuffer=function toArrayBuffer(){if(typeof Uint8Array!=="undefined"){if(Buffer.TYPED_ARRAY_SUPPORT){return new Buffer(this).buffer}else{var buf=new Uint8Array(this.length);for(var i=0,len=buf.length;i<len;i+=1){buf[i]=this[i]}return buf.buffer}}else{throw new TypeError("Buffer.toArrayBuffer not supported in this browser")}};var BP=Buffer.prototype;Buffer._augment=function _augment(arr){arr.constructor=Buffer;arr._isBuffer=true;arr._set=arr.set;arr.get=BP.get;arr.set=BP.set;arr.write=BP.write;arr.toString=BP.toString;arr.toLocaleString=BP.toString;arr.toJSON=BP.toJSON;arr.equals=BP.equals;arr.compare=BP.compare;arr.indexOf=BP.indexOf;arr.copy=BP.copy;arr.slice=BP.slice;arr.readUIntLE=BP.readUIntLE;arr.readUIntBE=BP.readUIntBE;arr.readUInt8=BP.readUInt8;arr.readUInt16LE=BP.readUInt16LE;arr.readUInt16BE=BP.readUInt16BE;arr.readUInt32LE=BP.readUInt32LE;arr.readUInt32BE=BP.readUInt32BE;arr.readIntLE=BP.readIntLE;arr.readIntBE=BP.readIntBE;arr.readInt8=BP.readInt8;arr.readInt16LE=BP.readInt16LE;arr.readInt16BE=BP.readInt16BE;arr.readInt32LE=BP.readInt32LE;arr.readInt32BE=BP.readInt32BE;arr.readFloatLE=BP.readFloatLE;arr.readFloatBE=BP.readFloatBE;arr.readDoubleLE=BP.readDoubleLE;arr.readDoubleBE=BP.readDoubleBE;arr.writeUInt8=BP.writeUInt8;arr.writeUIntLE=BP.writeUIntLE;arr.writeUIntBE=BP.writeUIntBE;arr.writeUInt16LE=BP.writeUInt16LE;arr.writeUInt16BE=BP.writeUInt16BE;arr.writeUInt32LE=BP.writeUInt32LE;arr.writeUInt32BE=BP.writeUInt32BE;arr.writeIntLE=BP.writeIntLE;arr.writeIntBE=BP.writeIntBE;arr.writeInt8=BP.writeInt8;arr.writeInt16LE=BP.writeInt16LE;arr.writeInt16BE=BP.writeInt16BE;arr.writeInt32LE=BP.writeInt32LE;arr.writeInt32BE=BP.writeInt32BE;arr.writeFloatLE=BP.writeFloatLE;arr.writeFloatBE=BP.writeFloatBE;arr.writeDoubleLE=BP.writeDoubleLE;arr.writeDoubleBE=BP.writeDoubleBE;arr.fill=BP.fill;arr.inspect=BP.inspect;arr.toArrayBuffer=BP.toArrayBuffer;return arr};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g;function base64clean(str){str=stringtrim(str).replace(INVALID_BASE64_RE,"");if(str.length<2)return"";while(str.length%4!==0){str=str+"="}return str}function stringtrim(str){if(str.trim)return str.trim();return str.replace(/^\s+|\s+$/g,"")}function toHex(n){if(n<16)return"0"+n.toString(16);return n.toString(16)}function utf8ToBytes(string,units){units=units||Infinity;var codePoint;var length=string.length;var leadSurrogate=null;var bytes=[];var i=0;for(;i<length;i++){codePoint=string.charCodeAt(i);if(codePoint>55295&&codePoint<57344){if(leadSurrogate){if(codePoint<56320){if((units-=3)>-1)bytes.push(239,191,189);leadSurrogate=codePoint;continue}else{codePoint=leadSurrogate-55296<<10|codePoint-56320|65536;leadSurrogate=null}}else{if(codePoint>56319){if((units-=3)>-1)bytes.push(239,191,189);continue}else if(i+1===length){if((units-=3)>-1)bytes.push(239,191,189);continue}else{leadSurrogate=codePoint;continue}}}else if(leadSurrogate){if((units-=3)>-1)bytes.push(239,191,189);leadSurrogate=null}if(codePoint<128){if((units-=1)<0)break;bytes.push(codePoint)}else if(codePoint<2048){if((units-=2)<0)break;bytes.push(codePoint>>6|192,codePoint&63|128)}else if(codePoint<65536){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,codePoint&63|128)}else if(codePoint<2097152){if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,codePoint&63|128)}else{throw new Error("Invalid code point")}}return bytes}function asciiToBytes(str){var byteArray=[];for(var i=0;i<str.length;i++){byteArray.push(str.charCodeAt(i)&255)}return byteArray}function utf16leToBytes(str,units){var c,hi,lo;var byteArray=[];for(var i=0;i<str.length;i++){if((units-=2)<0)break;c=str.charCodeAt(i);hi=c>>8;lo=c%256;byteArray.push(lo);byteArray.push(hi)}return byteArray}function base64ToBytes(str){return base64.toByteArray(base64clean(str))}function blitBuffer(src,dst,offset,length){for(var i=0;i<length;i++){if(i+offset>=dst.length||i>=src.length)break;dst[i+offset]=src[i]}return i}function decodeUtf8Char(str){try{return decodeURIComponent(str)}catch(err){return String.fromCharCode(65533)}}},{"base64-js":16,ieee754:17,"is-array":18}],16:[function(require,module,exports){var lookup="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";(function(exports){"use strict";var Arr=typeof Uint8Array!=="undefined"?Uint8Array:Array;var PLUS="+".charCodeAt(0);var SLASH="/".charCodeAt(0);var NUMBER="0".charCodeAt(0);var LOWER="a".charCodeAt(0);var UPPER="A".charCodeAt(0);var PLUS_URL_SAFE="-".charCodeAt(0);var SLASH_URL_SAFE="_".charCodeAt(0);function decode(elt){var code=elt.charCodeAt(0);if(code===PLUS||code===PLUS_URL_SAFE)return 62;if(code===SLASH||code===SLASH_URL_SAFE)return 63;if(code<NUMBER)return-1;if(code<NUMBER+10)return code-NUMBER+26+26;if(code<UPPER+26)return code-UPPER;if(code<LOWER+26)return code-LOWER+26}function b64ToByteArray(b64){var i,j,l,tmp,placeHolders,arr;if(b64.length%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}var len=b64.length;placeHolders="="===b64.charAt(len-2)?2:"="===b64.charAt(len-1)?1:0;arr=new Arr(b64.length*3/4-placeHolders);l=placeHolders>0?b64.length-4:b64.length;var L=0;function push(v){arr[L++]=v}for(i=0,j=0;i<l;i+=4,j+=3){tmp=decode(b64.charAt(i))<<18|decode(b64.charAt(i+1))<<12|decode(b64.charAt(i+2))<<6|decode(b64.charAt(i+3));push((tmp&16711680)>>16);push((tmp&65280)>>8);push(tmp&255)}if(placeHolders===2){tmp=decode(b64.charAt(i))<<2|decode(b64.charAt(i+1))>>4;push(tmp&255)}else if(placeHolders===1){tmp=decode(b64.charAt(i))<<10|decode(b64.charAt(i+1))<<4|decode(b64.charAt(i+2))>>2;push(tmp>>8&255);push(tmp&255)}return arr}function uint8ToBase64(uint8){var i,extraBytes=uint8.length%3,output="",temp,length;function encode(num){return lookup.charAt(num)}function tripletToBase64(num){return encode(num>>18&63)+encode(num>>12&63)+encode(num>>6&63)+encode(num&63)}for(i=0,length=uint8.length-extraBytes;i<length;i+=3){temp=(uint8[i]<<16)+(uint8[i+1]<<8)+uint8[i+2];output+=tripletToBase64(temp)}switch(extraBytes){case 1:temp=uint8[uint8.length-1];output+=encode(temp>>2);output+=encode(temp<<4&63);output+="==";break;case 2:temp=(uint8[uint8.length-2]<<8)+uint8[uint8.length-1];output+=encode(temp>>10);output+=encode(temp>>4&63);output+=encode(temp<<2&63);output+="=";break}return output}exports.toByteArray=b64ToByteArray;exports.fromByteArray=uint8ToBase64})(typeof exports==="undefined"?this.base64js={}:exports)},{}],17:[function(require,module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m;var eLen=nBytes*8-mLen-1;var eMax=(1<<eLen)-1;var eBias=eMax>>1;var nBits=-7;var i=isLE?nBytes-1:0;var d=isLE?-1:1;var s=buffer[offset+i];i+=d;e=s&(1<<-nBits)-1;s>>=-nBits;nBits+=eLen;for(;nBits>0;e=e*256+buffer[offset+i],i+=d,nBits-=8){}m=e&(1<<-nBits)-1;e>>=-nBits;nBits+=mLen;for(;nBits>0;m=m*256+buffer[offset+i],i+=d,nBits-=8){}if(e===0){e=1-eBias}else if(e===eMax){return m?NaN:(s?-1:1)*Infinity}else{m=m+Math.pow(2,mLen);e=e-eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)};exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c;var eLen=nBytes*8-mLen-1;var eMax=(1<<eLen)-1;var eBias=eMax>>1;var rt=mLen===23?Math.pow(2,-24)-Math.pow(2,-77):0;var i=isLE?0:nBytes-1;var d=isLE?1:-1;var s=value<0||value===0&&1/value<0?1:0;value=Math.abs(value);if(isNaN(value)||value===Infinity){m=isNaN(value)?1:0;e=eMax}else{e=Math.floor(Math.log(value)/Math.LN2);if(value*(c=Math.pow(2,-e))<1){e--;c*=2}if(e+eBias>=1){value+=rt/c}else{value+=rt*Math.pow(2,1-eBias)}if(value*c>=2){e++;c/=2}if(e+eBias>=eMax){m=0;e=eMax}else if(e+eBias>=1){m=(value*c-1)*Math.pow(2,mLen);e=e+eBias}else{m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen);e=0}}for(;mLen>=8;buffer[offset+i]=m&255,i+=d,m/=256,mLen-=8){}e=e<<mLen|m;eLen+=mLen;for(;eLen>0;buffer[offset+i]=e&255,i+=d,e/=256,eLen-=8){}buffer[offset+i-d]|=s*128}},{}],18:[function(require,module,exports){var isArray=Array.isArray;var str=Object.prototype.toString;module.exports=isArray||function(val){return!!val&&"[object Array]"==str.call(val)}},{}],19:[function(require,module,exports){function EventEmitter(){this._events=this._events||{};this._maxListeners=this._maxListeners||undefined}module.exports=EventEmitter;EventEmitter.EventEmitter=EventEmitter;EventEmitter.prototype._events=undefined;EventEmitter.prototype._maxListeners=undefined;EventEmitter.defaultMaxListeners=10;EventEmitter.prototype.setMaxListeners=function(n){if(!isNumber(n)||n<0||isNaN(n))throw TypeError("n must be a positive number");this._maxListeners=n;return this};EventEmitter.prototype.emit=function(type){var er,handler,len,args,i,listeners;if(!this._events)this._events={};if(type==="error"){if(!this._events.error||isObject(this._events.error)&&!this._events.error.length){er=arguments[1];if(er instanceof Error){throw er}throw TypeError('Uncaught, unspecified "error" event.')}}handler=this._events[type];if(isUndefined(handler))return false;if(isFunction(handler)){switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:len=arguments.length;args=new Array(len-1);for(i=1;i<len;i++)args[i-1]=arguments[i];handler.apply(this,args)}}else if(isObject(handler)){len=arguments.length;args=new Array(len-1);for(i=1;i<len;i++)args[i-1]=arguments[i];listeners=handler.slice();len=listeners.length;for(i=0;i<len;i++)listeners[i].apply(this,args)}return true};EventEmitter.prototype.addListener=function(type,listener){var m;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events)this._events={};if(this._events.newListener)this.emit("newListener",type,isFunction(listener.listener)?listener.listener:listener);if(!this._events[type])this._events[type]=listener;else if(isObject(this._events[type]))this._events[type].push(listener);else this._events[type]=[this._events[type],listener];if(isObject(this._events[type])&&!this._events[type].warned){var m;if(!isUndefined(this._maxListeners)){m=this._maxListeners}else{m=EventEmitter.defaultMaxListeners}if(m&&m>0&&this._events[type].length>m){this._events[type].warned=true;console.error("(node) warning: possible EventEmitter memory "+"leak detected. %d listeners added. "+"Use emitter.setMaxListeners() to increase limit.",this._events[type].length);if(typeof console.trace==="function"){console.trace()}}}return this};EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.once=function(type,listener){
if(!isFunction(listener))throw TypeError("listener must be a function");var fired=false;function g(){this.removeListener(type,g);if(!fired){fired=true;listener.apply(this,arguments)}}g.listener=listener;this.on(type,g);return this};EventEmitter.prototype.removeListener=function(type,listener){var list,position,length,i;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events||!this._events[type])return this;list=this._events[type];length=list.length;position=-1;if(list===listener||isFunction(list.listener)&&list.listener===listener){delete this._events[type];if(this._events.removeListener)this.emit("removeListener",type,listener)}else if(isObject(list)){for(i=length;i-->0;){if(list[i]===listener||list[i].listener&&list[i].listener===listener){position=i;break}}if(position<0)return this;if(list.length===1){list.length=0;delete this._events[type]}else{list.splice(position,1)}if(this._events.removeListener)this.emit("removeListener",type,listener)}return this};EventEmitter.prototype.removeAllListeners=function(type){var key,listeners;if(!this._events)return this;if(!this._events.removeListener){if(arguments.length===0)this._events={};else if(this._events[type])delete this._events[type];return this}if(arguments.length===0){for(key in this._events){if(key==="removeListener")continue;this.removeAllListeners(key)}this.removeAllListeners("removeListener");this._events={};return this}listeners=this._events[type];if(isFunction(listeners)){this.removeListener(type,listeners)}else{while(listeners.length)this.removeListener(type,listeners[listeners.length-1])}delete this._events[type];return this};EventEmitter.prototype.listeners=function(type){var ret;if(!this._events||!this._events[type])ret=[];else if(isFunction(this._events[type]))ret=[this._events[type]];else ret=this._events[type].slice();return ret};EventEmitter.listenerCount=function(emitter,type){var ret;if(!emitter._events||!emitter._events[type])ret=0;else if(isFunction(emitter._events[type]))ret=1;else ret=emitter._events[type].length;return ret};function isFunction(arg){return typeof arg==="function"}function isNumber(arg){return typeof arg==="number"}function isObject(arg){return typeof arg==="object"&&arg!==null}function isUndefined(arg){return arg===void 0}},{}],20:[function(require,module,exports){var http=require("http");var https=module.exports;for(var key in http){if(http.hasOwnProperty(key))https[key]=http[key]}https.request=function(params,cb){if(!params)params={};params.scheme="https";return http.request.call(this,params,cb)}},{http:42}],21:[function(require,module,exports){if(typeof Object.create==="function"){module.exports=function inherits(ctor,superCtor){ctor.super_=superCtor;ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:false,writable:true,configurable:true}})}}else{module.exports=function inherits(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype;ctor.prototype=new TempCtor;ctor.prototype.constructor=ctor}}},{}],22:[function(require,module,exports){module.exports=Array.isArray||function(arr){return Object.prototype.toString.call(arr)=="[object Array]"}},{}],23:[function(require,module,exports){var process=module.exports={};var queue=[];var draining=false;var currentQueue;var queueIndex=-1;function cleanUpNextTick(){draining=false;if(currentQueue.length){queue=currentQueue.concat(queue)}else{queueIndex=-1}if(queue.length){drainQueue()}}function drainQueue(){if(draining){return}var timeout=setTimeout(cleanUpNextTick);draining=true;var len=queue.length;while(len){currentQueue=queue;queue=[];while(++queueIndex<len){currentQueue[queueIndex].run()}queueIndex=-1;len=queue.length}currentQueue=null;draining=false;clearTimeout(timeout)}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1){for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i]}}queue.push(new Item(fun,args));if(queue.length===1&&!draining){setTimeout(drainQueue,0)}};function Item(fun,array){this.fun=fun;this.array=array}Item.prototype.run=function(){this.fun.apply(null,this.array)};process.title="browser";process.browser=true;process.env={};process.argv=[];process.version="";process.versions={};function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.binding=function(name){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported")};process.umask=function(){return 0}},{}],24:[function(require,module,exports){(function(global){(function(root){var freeExports=typeof exports=="object"&&exports&&!exports.nodeType&&exports;var freeModule=typeof module=="object"&&module&&!module.nodeType&&module;var freeGlobal=typeof global=="object"&&global;if(freeGlobal.global===freeGlobal||freeGlobal.window===freeGlobal||freeGlobal.self===freeGlobal){root=freeGlobal}var punycode,maxInt=2147483647,base=36,tMin=1,tMax=26,skew=38,damp=700,initialBias=72,initialN=128,delimiter="-",regexPunycode=/^xn--/,regexNonASCII=/[^\x20-\x7E]/,regexSeparators=/[\x2E\u3002\uFF0E\uFF61]/g,errors={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},baseMinusTMin=base-tMin,floor=Math.floor,stringFromCharCode=String.fromCharCode,key;function error(type){throw RangeError(errors[type])}function map(array,fn){var length=array.length;var result=[];while(length--){result[length]=fn(array[length])}return result}function mapDomain(string,fn){var parts=string.split("@");var result="";if(parts.length>1){result=parts[0]+"@";string=parts[1]}string=string.replace(regexSeparators,".");var labels=string.split(".");var encoded=map(labels,fn).join(".");return result+encoded}function ucs2decode(string){var output=[],counter=0,length=string.length,value,extra;while(counter<length){value=string.charCodeAt(counter++);if(value>=55296&&value<=56319&&counter<length){extra=string.charCodeAt(counter++);if((extra&64512)==56320){output.push(((value&1023)<<10)+(extra&1023)+65536)}else{output.push(value);counter--}}else{output.push(value)}}return output}function ucs2encode(array){return map(array,function(value){var output="";if(value>65535){value-=65536;output+=stringFromCharCode(value>>>10&1023|55296);value=56320|value&1023}output+=stringFromCharCode(value);return output}).join("")}function basicToDigit(codePoint){if(codePoint-48<10){return codePoint-22}if(codePoint-65<26){return codePoint-65}if(codePoint-97<26){return codePoint-97}return base}function digitToBasic(digit,flag){return digit+22+75*(digit<26)-((flag!=0)<<5)}function adapt(delta,numPoints,firstTime){var k=0;delta=firstTime?floor(delta/damp):delta>>1;delta+=floor(delta/numPoints);for(;delta>baseMinusTMin*tMax>>1;k+=base){delta=floor(delta/baseMinusTMin)}return floor(k+(baseMinusTMin+1)*delta/(delta+skew))}function decode(input){var output=[],inputLength=input.length,out,i=0,n=initialN,bias=initialBias,basic,j,index,oldi,w,k,digit,t,baseMinusT;basic=input.lastIndexOf(delimiter);if(basic<0){basic=0}for(j=0;j<basic;++j){if(input.charCodeAt(j)>=128){error("not-basic")}output.push(input.charCodeAt(j))}for(index=basic>0?basic+1:0;index<inputLength;){for(oldi=i,w=1,k=base;;k+=base){if(index>=inputLength){error("invalid-input")}digit=basicToDigit(input.charCodeAt(index++));if(digit>=base||digit>floor((maxInt-i)/w)){error("overflow")}i+=digit*w;t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias;if(digit<t){break}baseMinusT=base-t;if(w>floor(maxInt/baseMinusT)){error("overflow")}w*=baseMinusT}out=output.length+1;bias=adapt(i-oldi,out,oldi==0);if(floor(i/out)>maxInt-n){error("overflow")}n+=floor(i/out);i%=out;output.splice(i++,0,n)}return ucs2encode(output)}function encode(input){var n,delta,handledCPCount,basicLength,bias,j,m,q,k,t,currentValue,output=[],inputLength,handledCPCountPlusOne,baseMinusT,qMinusT;input=ucs2decode(input);inputLength=input.length;n=initialN;delta=0;bias=initialBias;for(j=0;j<inputLength;++j){currentValue=input[j];if(currentValue<128){output.push(stringFromCharCode(currentValue))}}handledCPCount=basicLength=output.length;if(basicLength){output.push(delimiter)}while(handledCPCount<inputLength){for(m=maxInt,j=0;j<inputLength;++j){currentValue=input[j];if(currentValue>=n&&currentValue<m){m=currentValue}}handledCPCountPlusOne=handledCPCount+1;if(m-n>floor((maxInt-delta)/handledCPCountPlusOne)){error("overflow")}delta+=(m-n)*handledCPCountPlusOne;n=m;for(j=0;j<inputLength;++j){currentValue=input[j];if(currentValue<n&&++delta>maxInt){error("overflow")}if(currentValue==n){for(q=delta,k=base;;k+=base){t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias;if(q<t){break}qMinusT=q-t;baseMinusT=base-t;output.push(stringFromCharCode(digitToBasic(t+qMinusT%baseMinusT,0)));q=floor(qMinusT/baseMinusT)}output.push(stringFromCharCode(digitToBasic(q,0)));bias=adapt(delta,handledCPCountPlusOne,handledCPCount==basicLength);delta=0;++handledCPCount}}++delta;++n}return output.join("")}function toUnicode(input){return mapDomain(input,function(string){return regexPunycode.test(string)?decode(string.slice(4).toLowerCase()):string})}function toASCII(input){return mapDomain(input,function(string){return regexNonASCII.test(string)?"xn--"+encode(string):string})}punycode={version:"1.3.2",ucs2:{decode:ucs2decode,encode:ucs2encode},decode:decode,encode:encode,toASCII:toASCII,toUnicode:toUnicode};if(typeof define=="function"&&typeof define.amd=="object"&&define.amd){define("punycode",function(){return punycode})}else if(freeExports&&freeModule){if(module.exports==freeExports){freeModule.exports=punycode}else{for(key in punycode){punycode.hasOwnProperty(key)&&(freeExports[key]=punycode[key])}}}else{root.punycode=punycode}})(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],25:[function(require,module,exports){"use strict";function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}module.exports=function(qs,sep,eq,options){sep=sep||"&";eq=eq||"=";var obj={};if(typeof qs!=="string"||qs.length===0){return obj}var regexp=/\+/g;qs=qs.split(sep);var maxKeys=1e3;if(options&&typeof options.maxKeys==="number"){maxKeys=options.maxKeys}var len=qs.length;if(maxKeys>0&&len>maxKeys){len=maxKeys}for(var i=0;i<len;++i){var x=qs[i].replace(regexp,"%20"),idx=x.indexOf(eq),kstr,vstr,k,v;if(idx>=0){kstr=x.substr(0,idx);vstr=x.substr(idx+1)}else{kstr=x;vstr=""}k=decodeURIComponent(kstr);v=decodeURIComponent(vstr);if(!hasOwnProperty(obj,k)){obj[k]=v}else if(isArray(obj[k])){obj[k].push(v)}else{obj[k]=[obj[k],v]}}return obj};var isArray=Array.isArray||function(xs){return Object.prototype.toString.call(xs)==="[object Array]"}},{}],26:[function(require,module,exports){"use strict";var stringifyPrimitive=function(v){switch(typeof v){case"string":return v;case"boolean":return v?"true":"false";case"number":return isFinite(v)?v:"";default:return""}};module.exports=function(obj,sep,eq,name){sep=sep||"&";eq=eq||"=";if(obj===null){obj=undefined}if(typeof obj==="object"){return map(objectKeys(obj),function(k){var ks=encodeURIComponent(stringifyPrimitive(k))+eq;if(isArray(obj[k])){return map(obj[k],function(v){return ks+encodeURIComponent(stringifyPrimitive(v))}).join(sep)}else{return ks+encodeURIComponent(stringifyPrimitive(obj[k]))}}).join(sep)}if(!name)return"";return encodeURIComponent(stringifyPrimitive(name))+eq+encodeURIComponent(stringifyPrimitive(obj))};var isArray=Array.isArray||function(xs){return Object.prototype.toString.call(xs)==="[object Array]"};function map(xs,f){if(xs.map)return xs.map(f);var res=[];for(var i=0;i<xs.length;i++){res.push(f(xs[i],i))}return res}var objectKeys=Object.keys||function(obj){var res=[];for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))res.push(key)}return res}},{}],27:[function(require,module,exports){"use strict";exports.decode=exports.parse=require("./decode");exports.encode=exports.stringify=require("./encode")},{"./decode":25,"./encode":26}],28:[function(require,module,exports){module.exports=require("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":29}],29:[function(require,module,exports){"use strict";var objectKeys=Object.keys||function(obj){var keys=[];for(var key in obj)keys.push(key);return keys};module.exports=Duplex;var processNextTick=require("process-nextick-args");var util=require("core-util-is");util.inherits=require("inherits");var Readable=require("./_stream_readable");var Writable=require("./_stream_writable");util.inherits(Duplex,Readable);var keys=objectKeys(Writable.prototype);for(var v=0;v<keys.length;v++){var method=keys[v];if(!Duplex.prototype[method])Duplex.prototype[method]=Writable.prototype[method]}function Duplex(options){if(!(this instanceof Duplex))return new Duplex(options);Readable.call(this,options);Writable.call(this,options);if(options&&options.readable===false)this.readable=false;if(options&&options.writable===false)this.writable=false;this.allowHalfOpen=true;if(options&&options.allowHalfOpen===false)this.allowHalfOpen=false;this.once("end",onend)}function onend(){if(this.allowHalfOpen||this._writableState.ended)return;processNextTick(onEndNT,this)}function onEndNT(self){self.end()}function forEach(xs,f){for(var i=0,l=xs.length;i<l;i++){f(xs[i],i)}}},{"./_stream_readable":31,"./_stream_writable":33,"core-util-is":34,inherits:21,"process-nextick-args":35}],30:[function(require,module,exports){"use strict";module.exports=PassThrough;var Transform=require("./_stream_transform");var util=require("core-util-is");util.inherits=require("inherits");util.inherits(PassThrough,Transform);function PassThrough(options){if(!(this instanceof PassThrough))return new PassThrough(options);Transform.call(this,options)}PassThrough.prototype._transform=function(chunk,encoding,cb){cb(null,chunk)}},{"./_stream_transform":32,"core-util-is":34,inherits:21}],31:[function(require,module,exports){(function(process){"use strict";module.exports=Readable;var processNextTick=require("process-nextick-args");var isArray=require("isarray");var Buffer=require("buffer").Buffer;Readable.ReadableState=ReadableState;var EE=require("events").EventEmitter;if(!EE.listenerCount)EE.listenerCount=function(emitter,type){return emitter.listeners(type).length};var Stream;(function(){try{Stream=require("st"+"ream")}catch(_){}finally{if(!Stream)Stream=require("events").EventEmitter}})();var Buffer=require("buffer").Buffer;var util=require("core-util-is");util.inherits=require("inherits");var debug=require("util");if(debug&&debug.debuglog){debug=debug.debuglog("stream")}else{debug=function(){}}var StringDecoder;util.inherits(Readable,Stream);function ReadableState(options,stream){var Duplex=require("./_stream_duplex");options=options||{};this.objectMode=!!options.objectMode;if(stream instanceof Duplex)this.objectMode=this.objectMode||!!options.readableObjectMode;var hwm=options.highWaterMark;var defaultHwm=this.objectMode?16:16*1024;this.highWaterMark=hwm||hwm===0?hwm:defaultHwm;this.highWaterMark=~~this.highWaterMark;this.buffer=[];this.length=0;this.pipes=null;this.pipesCount=0;this.flowing=null;this.ended=false;this.endEmitted=false;this.reading=false;this.sync=true;this.needReadable=false;this.emittedReadable=false;this.readableListening=false;this.defaultEncoding=options.defaultEncoding||"utf8";this.ranOut=false;this.awaitDrain=0;this.readingMore=false;this.decoder=null;this.encoding=null;if(options.encoding){if(!StringDecoder)StringDecoder=require("string_decoder/").StringDecoder;this.decoder=new StringDecoder(options.encoding);this.encoding=options.encoding}}function Readable(options){var Duplex=require("./_stream_duplex");if(!(this instanceof Readable))return new Readable(options);this._readableState=new ReadableState(options,this);this.readable=true;if(options&&typeof options.read==="function")this._read=options.read;Stream.call(this)}Readable.prototype.push=function(chunk,encoding){var state=this._readableState;if(!state.objectMode&&typeof chunk==="string"){encoding=encoding||state.defaultEncoding;if(encoding!==state.encoding){chunk=new Buffer(chunk,encoding);encoding=""}}return readableAddChunk(this,state,chunk,encoding,false)};Readable.prototype.unshift=function(chunk){var state=this._readableState;return readableAddChunk(this,state,chunk,"",true)};Readable.prototype.isPaused=function(){return this._readableState.flowing===false};function readableAddChunk(stream,state,chunk,encoding,addToFront){var er=chunkInvalid(state,chunk);if(er){stream.emit("error",er)}else if(chunk===null){state.reading=false;onEofChunk(stream,state)}else if(state.objectMode||chunk&&chunk.length>0){if(state.ended&&!addToFront){var e=new Error("stream.push() after EOF");stream.emit("error",e)}else if(state.endEmitted&&addToFront){var e=new Error("stream.unshift() after end event");stream.emit("error",e)}else{if(state.decoder&&!addToFront&&!encoding)chunk=state.decoder.write(chunk);if(!addToFront)state.reading=false;if(state.flowing&&state.length===0&&!state.sync){stream.emit("data",chunk);stream.read(0)}else{state.length+=state.objectMode?1:chunk.length;if(addToFront)state.buffer.unshift(chunk);else state.buffer.push(chunk);if(state.needReadable)emitReadable(stream)}maybeReadMore(stream,state)}}else if(!addToFront){state.reading=false}return needMoreData(state)}function needMoreData(state){return!state.ended&&(state.needReadable||state.length<state.highWaterMark||state.length===0)}Readable.prototype.setEncoding=function(enc){if(!StringDecoder)StringDecoder=require("string_decoder/").StringDecoder;this._readableState.decoder=new StringDecoder(enc);this._readableState.encoding=enc;return this};var MAX_HWM=8388608;function roundUpToNextPowerOf2(n){if(n>=MAX_HWM){n=MAX_HWM}else{n--;for(var p=1;p<32;p<<=1)n|=n>>p;n++}return n}function howMuchToRead(n,state){if(state.length===0&&state.ended)return 0;if(state.objectMode)return n===0?0:1;if(n===null||isNaN(n)){if(state.flowing&&state.buffer.length)return state.buffer[0].length;else return state.length}if(n<=0)return 0;if(n>state.highWaterMark)state.highWaterMark=roundUpToNextPowerOf2(n);if(n>state.length){if(!state.ended){state.needReadable=true;return 0}else{return state.length}}return n}Readable.prototype.read=function(n){debug("read",n);var state=this._readableState;var nOrig=n;if(typeof n!=="number"||n>0)state.emittedReadable=false;if(n===0&&state.needReadable&&(state.length>=state.highWaterMark||state.ended)){debug("read: emitReadable",state.length,state.ended);if(state.length===0&&state.ended)endReadable(this);else emitReadable(this);return null}n=howMuchToRead(n,state);if(n===0&&state.ended){if(state.length===0)endReadable(this);return null}var doRead=state.needReadable;debug("need readable",doRead);if(state.length===0||state.length-n<state.highWaterMark){doRead=true;debug("length less than watermark",doRead)}if(state.ended||state.reading){doRead=false;debug("reading or ended",doRead)}if(doRead){debug("do read");state.reading=true;state.sync=true;if(state.length===0)state.needReadable=true;this._read(state.highWaterMark);state.sync=false}if(doRead&&!state.reading)n=howMuchToRead(nOrig,state);var ret;if(n>0)ret=fromList(n,state);else ret=null;if(ret===null){state.needReadable=true;n=0}state.length-=n;if(state.length===0&&!state.ended)state.needReadable=true;if(nOrig!==n&&state.ended&&state.length===0)endReadable(this);if(ret!==null)this.emit("data",ret);return ret};function chunkInvalid(state,chunk){var er=null;if(!Buffer.isBuffer(chunk)&&typeof chunk!=="string"&&chunk!==null&&chunk!==undefined&&!state.objectMode){er=new TypeError("Invalid non-string/buffer chunk")}return er}function onEofChunk(stream,state){if(state.ended)return;if(state.decoder){var chunk=state.decoder.end();if(chunk&&chunk.length){state.buffer.push(chunk);state.length+=state.objectMode?1:chunk.length}}state.ended=true;emitReadable(stream)}function emitReadable(stream){var state=stream._readableState;state.needReadable=false;if(!state.emittedReadable){debug("emitReadable",state.flowing);state.emittedReadable=true;if(state.sync)processNextTick(emitReadable_,stream);else emitReadable_(stream)}}function emitReadable_(stream){debug("emit readable");stream.emit("readable");flow(stream)}function maybeReadMore(stream,state){if(!state.readingMore){state.readingMore=true;processNextTick(maybeReadMore_,stream,state)}}function maybeReadMore_(stream,state){var len=state.length;while(!state.reading&&!state.flowing&&!state.ended&&state.length<state.highWaterMark){debug("maybeReadMore read 0");stream.read(0);if(len===state.length)break;else len=state.length}state.readingMore=false}Readable.prototype._read=function(n){this.emit("error",new Error("not implemented"))};Readable.prototype.pipe=function(dest,pipeOpts){var src=this;var state=this._readableState;switch(state.pipesCount){case 0:state.pipes=dest;break;case 1:state.pipes=[state.pipes,dest];break;default:state.pipes.push(dest);break}state.pipesCount+=1;debug("pipe count=%d opts=%j",state.pipesCount,pipeOpts);var doEnd=(!pipeOpts||pipeOpts.end!==false)&&dest!==process.stdout&&dest!==process.stderr;var endFn=doEnd?onend:cleanup;if(state.endEmitted)processNextTick(endFn);else src.once("end",endFn);dest.on("unpipe",onunpipe);function onunpipe(readable){debug("onunpipe");if(readable===src){cleanup()}}function onend(){debug("onend");dest.end()}var ondrain=pipeOnDrain(src);dest.on("drain",ondrain);function cleanup(){debug("cleanup");dest.removeListener("close",onclose);dest.removeListener("finish",onfinish);dest.removeListener("drain",ondrain);dest.removeListener("error",onerror);dest.removeListener("unpipe",onunpipe);src.removeListener("end",onend);src.removeListener("end",cleanup);src.removeListener("data",ondata);if(state.awaitDrain&&(!dest._writableState||dest._writableState.needDrain))ondrain()}src.on("data",ondata);function ondata(chunk){debug("ondata");var ret=dest.write(chunk);if(false===ret){debug("false write response, pause",src._readableState.awaitDrain);src._readableState.awaitDrain++;src.pause()}}function onerror(er){debug("onerror",er);unpipe();dest.removeListener("error",onerror);if(EE.listenerCount(dest,"error")===0)dest.emit("error",er)}if(!dest._events||!dest._events.error)dest.on("error",onerror);else if(isArray(dest._events.error))dest._events.error.unshift(onerror);else dest._events.error=[onerror,dest._events.error];function onclose(){dest.removeListener("finish",onfinish);unpipe()}dest.once("close",onclose);function onfinish(){debug("onfinish");dest.removeListener("close",onclose);unpipe()}dest.once("finish",onfinish);function unpipe(){debug("unpipe");src.unpipe(dest)}dest.emit("pipe",src);if(!state.flowing){debug("pipe resume");src.resume()}return dest};function pipeOnDrain(src){return function(){var state=src._readableState;debug("pipeOnDrain",state.awaitDrain);if(state.awaitDrain)state.awaitDrain--;if(state.awaitDrain===0&&EE.listenerCount(src,"data")){state.flowing=true;flow(src)}}}Readable.prototype.unpipe=function(dest){var state=this._readableState;if(state.pipesCount===0)return this;if(state.pipesCount===1){if(dest&&dest!==state.pipes)return this;if(!dest)dest=state.pipes;state.pipes=null;state.pipesCount=0;state.flowing=false;if(dest)dest.emit("unpipe",this);return this}if(!dest){var dests=state.pipes;var len=state.pipesCount;state.pipes=null;state.pipesCount=0;state.flowing=false;for(var i=0;i<len;i++)dests[i].emit("unpipe",this);return this}var i=indexOf(state.pipes,dest);if(i===-1)return this;state.pipes.splice(i,1);state.pipesCount-=1;if(state.pipesCount===1)state.pipes=state.pipes[0];dest.emit("unpipe",this);return this};Readable.prototype.on=function(ev,fn){var res=Stream.prototype.on.call(this,ev,fn);if(ev==="data"&&false!==this._readableState.flowing){this.resume()}if(ev==="readable"&&this.readable){var state=this._readableState;if(!state.readableListening){state.readableListening=true;state.emittedReadable=false;state.needReadable=true;if(!state.reading){processNextTick(nReadingNextTick,this)}else if(state.length){emitReadable(this,state)}}}return res};Readable.prototype.addListener=Readable.prototype.on;function nReadingNextTick(self){debug("readable nexttick read 0");self.read(0)}Readable.prototype.resume=function(){var state=this._readableState;if(!state.flowing){debug("resume");state.flowing=true;resume(this,state)}return this};function resume(stream,state){if(!state.resumeScheduled){state.resumeScheduled=true;processNextTick(resume_,stream,state)}}function resume_(stream,state){if(!state.reading){debug("resume read 0");stream.read(0)}state.resumeScheduled=false;stream.emit("resume");flow(stream);if(state.flowing&&!state.reading)stream.read(0)}Readable.prototype.pause=function(){debug("call pause flowing=%j",this._readableState.flowing);if(false!==this._readableState.flowing){debug("pause");this._readableState.flowing=false;this.emit("pause")}return this};function flow(stream){var state=stream._readableState;debug("flow",state.flowing);if(state.flowing){do{var chunk=stream.read()}while(null!==chunk&&state.flowing)}}Readable.prototype.wrap=function(stream){var state=this._readableState;var paused=false;var self=this;stream.on("end",function(){debug("wrapped end");if(state.decoder&&!state.ended){var chunk=state.decoder.end();if(chunk&&chunk.length)self.push(chunk)}self.push(null)});stream.on("data",function(chunk){debug("wrapped data");if(state.decoder)chunk=state.decoder.write(chunk);if(state.objectMode&&(chunk===null||chunk===undefined))return;else if(!state.objectMode&&(!chunk||!chunk.length))return;var ret=self.push(chunk);if(!ret){paused=true;stream.pause()}});for(var i in stream){if(this[i]===undefined&&typeof stream[i]==="function"){this[i]=function(method){return function(){return stream[method].apply(stream,arguments)}}(i)}}var events=["error","close","destroy","pause","resume"];forEach(events,function(ev){stream.on(ev,self.emit.bind(self,ev))});self._read=function(n){debug("wrapped _read",n);if(paused){paused=false;stream.resume()}};return self};Readable._fromList=fromList;function fromList(n,state){var list=state.buffer;var length=state.length;var stringMode=!!state.decoder;var objectMode=!!state.objectMode;var ret;if(list.length===0)return null;if(length===0)ret=null;else if(objectMode)ret=list.shift();else if(!n||n>=length){if(stringMode)ret=list.join("");else ret=Buffer.concat(list,length);list.length=0}else{if(n<list[0].length){var buf=list[0];ret=buf.slice(0,n);list[0]=buf.slice(n)}else if(n===list[0].length){ret=list.shift()}else{if(stringMode)ret="";else ret=new Buffer(n);var c=0;for(var i=0,l=list.length;i<l&&c<n;i++){var buf=list[0];var cpy=Math.min(n-c,buf.length);if(stringMode)ret+=buf.slice(0,cpy);else buf.copy(ret,c,0,cpy);if(cpy<buf.length)list[0]=buf.slice(cpy);else list.shift();c+=cpy}}}return ret}function endReadable(stream){var state=stream._readableState;if(state.length>0)throw new Error("endReadable called on non-empty stream");if(!state.endEmitted){state.ended=true;processNextTick(endReadableNT,state,stream)}}function endReadableNT(state,stream){if(!state.endEmitted&&state.length===0){state.endEmitted=true;stream.readable=false;stream.emit("end")}}function forEach(xs,f){for(var i=0,l=xs.length;i<l;i++){f(xs[i],i)}}function indexOf(xs,x){for(var i=0,l=xs.length;i<l;i++){if(xs[i]===x)return i}return-1}}).call(this,require("_process"))},{"./_stream_duplex":29,_process:23,buffer:15,"core-util-is":34,events:19,inherits:21,isarray:22,"process-nextick-args":35,"string_decoder/":51,util:14}],32:[function(require,module,exports){"use strict";module.exports=Transform;var Duplex=require("./_stream_duplex");var util=require("core-util-is");util.inherits=require("inherits");util.inherits(Transform,Duplex);function TransformState(stream){this.afterTransform=function(er,data){return afterTransform(stream,er,data)};this.needTransform=false;this.transforming=false;this.writecb=null;this.writechunk=null}function afterTransform(stream,er,data){var ts=stream._transformState;ts.transforming=false;var cb=ts.writecb;if(!cb)return stream.emit("error",new Error("no writecb in Transform class"));ts.writechunk=null;ts.writecb=null;if(data!==null&&data!==undefined)stream.push(data);if(cb)cb(er);var rs=stream._readableState;rs.reading=false;if(rs.needReadable||rs.length<rs.highWaterMark){stream._read(rs.highWaterMark)}}function Transform(options){if(!(this instanceof Transform))return new Transform(options);Duplex.call(this,options);this._transformState=new TransformState(this);var stream=this;this._readableState.needReadable=true;this._readableState.sync=false;if(options){if(typeof options.transform==="function")this._transform=options.transform;if(typeof options.flush==="function")this._flush=options.flush}this.once("prefinish",function(){if(typeof this._flush==="function")this._flush(function(er){done(stream,er)});else done(stream)})}Transform.prototype.push=function(chunk,encoding){this._transformState.needTransform=false;return Duplex.prototype.push.call(this,chunk,encoding)};Transform.prototype._transform=function(chunk,encoding,cb){throw new Error("not implemented")};Transform.prototype._write=function(chunk,encoding,cb){var ts=this._transformState;ts.writecb=cb;ts.writechunk=chunk;ts.writeencoding=encoding;if(!ts.transforming){var rs=this._readableState;if(ts.needTransform||rs.needReadable||rs.length<rs.highWaterMark)this._read(rs.highWaterMark)}};Transform.prototype._read=function(n){var ts=this._transformState;if(ts.writechunk!==null&&ts.writecb&&!ts.transforming){ts.transforming=true;this._transform(ts.writechunk,ts.writeencoding,ts.afterTransform)}else{ts.needTransform=true}};function done(stream,er){if(er)return stream.emit("error",er);var ws=stream._writableState;var ts=stream._transformState;if(ws.length)throw new Error("calling transform done when ws.length != 0");if(ts.transforming)throw new Error("calling transform done when still transforming");return stream.push(null)}},{"./_stream_duplex":29,"core-util-is":34,inherits:21}],33:[function(require,module,exports){"use strict";module.exports=Writable;var processNextTick=require("process-nextick-args");var Buffer=require("buffer").Buffer;Writable.WritableState=WritableState;var util=require("core-util-is");util.inherits=require("inherits");var Stream;(function(){try{Stream=require("st"+"ream")}catch(_){}finally{if(!Stream)Stream=require("events").EventEmitter}})();var Buffer=require("buffer").Buffer;util.inherits(Writable,Stream);function nop(){}function WriteReq(chunk,encoding,cb){this.chunk=chunk;this.encoding=encoding;this.callback=cb;this.next=null}function WritableState(options,stream){var Duplex=require("./_stream_duplex");options=options||{};this.objectMode=!!options.objectMode;if(stream instanceof Duplex)this.objectMode=this.objectMode||!!options.writableObjectMode;var hwm=options.highWaterMark;var defaultHwm=this.objectMode?16:16*1024;this.highWaterMark=hwm||hwm===0?hwm:defaultHwm;this.highWaterMark=~~this.highWaterMark;this.needDrain=false;this.ending=false;this.ended=false;this.finished=false;var noDecode=options.decodeStrings===false;this.decodeStrings=!noDecode;this.defaultEncoding=options.defaultEncoding||"utf8";this.length=0;this.writing=false;this.corked=0;this.sync=true;this.bufferProcessing=false;this.onwrite=function(er){onwrite(stream,er)};this.writecb=null;this.writelen=0;this.bufferedRequest=null;this.lastBufferedRequest=null;this.pendingcb=0;this.prefinished=false;this.errorEmitted=false}WritableState.prototype.getBuffer=function writableStateGetBuffer(){var current=this.bufferedRequest;var out=[];while(current){out.push(current);current=current.next}return out};(function(){try{Object.defineProperty(WritableState.prototype,"buffer",{get:require("util-deprecate")(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use "+"_writableState.getBuffer() instead.")})}catch(_){}})();function Writable(options){var Duplex=require("./_stream_duplex");
if(!(this instanceof Writable)&&!(this instanceof Duplex))return new Writable(options);this._writableState=new WritableState(options,this);this.writable=true;if(options){if(typeof options.write==="function")this._write=options.write;if(typeof options.writev==="function")this._writev=options.writev}Stream.call(this)}Writable.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))};function writeAfterEnd(stream,cb){var er=new Error("write after end");stream.emit("error",er);processNextTick(cb,er)}function validChunk(stream,state,chunk,cb){var valid=true;if(!Buffer.isBuffer(chunk)&&typeof chunk!=="string"&&chunk!==null&&chunk!==undefined&&!state.objectMode){var er=new TypeError("Invalid non-string/buffer chunk");stream.emit("error",er);processNextTick(cb,er);valid=false}return valid}Writable.prototype.write=function(chunk,encoding,cb){var state=this._writableState;var ret=false;if(typeof encoding==="function"){cb=encoding;encoding=null}if(Buffer.isBuffer(chunk))encoding="buffer";else if(!encoding)encoding=state.defaultEncoding;if(typeof cb!=="function")cb=nop;if(state.ended)writeAfterEnd(this,cb);else if(validChunk(this,state,chunk,cb)){state.pendingcb++;ret=writeOrBuffer(this,state,chunk,encoding,cb)}return ret};Writable.prototype.cork=function(){var state=this._writableState;state.corked++};Writable.prototype.uncork=function(){var state=this._writableState;if(state.corked){state.corked--;if(!state.writing&&!state.corked&&!state.finished&&!state.bufferProcessing&&state.bufferedRequest)clearBuffer(this,state)}};Writable.prototype.setDefaultEncoding=function setDefaultEncoding(encoding){if(typeof encoding==="string")encoding=encoding.toLowerCase();if(!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((encoding+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+encoding);this._writableState.defaultEncoding=encoding};function decodeChunk(state,chunk,encoding){if(!state.objectMode&&state.decodeStrings!==false&&typeof chunk==="string"){chunk=new Buffer(chunk,encoding)}return chunk}function writeOrBuffer(stream,state,chunk,encoding,cb){chunk=decodeChunk(state,chunk,encoding);if(Buffer.isBuffer(chunk))encoding="buffer";var len=state.objectMode?1:chunk.length;state.length+=len;var ret=state.length<state.highWaterMark;if(!ret)state.needDrain=true;if(state.writing||state.corked){var last=state.lastBufferedRequest;state.lastBufferedRequest=new WriteReq(chunk,encoding,cb);if(last){last.next=state.lastBufferedRequest}else{state.bufferedRequest=state.lastBufferedRequest}}else{doWrite(stream,state,false,len,chunk,encoding,cb)}return ret}function doWrite(stream,state,writev,len,chunk,encoding,cb){state.writelen=len;state.writecb=cb;state.writing=true;state.sync=true;if(writev)stream._writev(chunk,state.onwrite);else stream._write(chunk,encoding,state.onwrite);state.sync=false}function onwriteError(stream,state,sync,er,cb){--state.pendingcb;if(sync)processNextTick(cb,er);else cb(er);stream._writableState.errorEmitted=true;stream.emit("error",er)}function onwriteStateUpdate(state){state.writing=false;state.writecb=null;state.length-=state.writelen;state.writelen=0}function onwrite(stream,er){var state=stream._writableState;var sync=state.sync;var cb=state.writecb;onwriteStateUpdate(state);if(er)onwriteError(stream,state,sync,er,cb);else{var finished=needFinish(state);if(!finished&&!state.corked&&!state.bufferProcessing&&state.bufferedRequest){clearBuffer(stream,state)}if(sync){processNextTick(afterWrite,stream,state,finished,cb)}else{afterWrite(stream,state,finished,cb)}}}function afterWrite(stream,state,finished,cb){if(!finished)onwriteDrain(stream,state);state.pendingcb--;cb();finishMaybe(stream,state)}function onwriteDrain(stream,state){if(state.length===0&&state.needDrain){state.needDrain=false;stream.emit("drain")}}function clearBuffer(stream,state){state.bufferProcessing=true;var entry=state.bufferedRequest;if(stream._writev&&entry&&entry.next){var buffer=[];var cbs=[];while(entry){cbs.push(entry.callback);buffer.push(entry);entry=entry.next}state.pendingcb++;state.lastBufferedRequest=null;doWrite(stream,state,true,state.length,buffer,"",function(err){for(var i=0;i<cbs.length;i++){state.pendingcb--;cbs[i](err)}})}else{while(entry){var chunk=entry.chunk;var encoding=entry.encoding;var cb=entry.callback;var len=state.objectMode?1:chunk.length;doWrite(stream,state,false,len,chunk,encoding,cb);entry=entry.next;if(state.writing){break}}if(entry===null)state.lastBufferedRequest=null}state.bufferedRequest=entry;state.bufferProcessing=false}Writable.prototype._write=function(chunk,encoding,cb){cb(new Error("not implemented"))};Writable.prototype._writev=null;Writable.prototype.end=function(chunk,encoding,cb){var state=this._writableState;if(typeof chunk==="function"){cb=chunk;chunk=null;encoding=null}else if(typeof encoding==="function"){cb=encoding;encoding=null}if(chunk!==null&&chunk!==undefined)this.write(chunk,encoding);if(state.corked){state.corked=1;this.uncork()}if(!state.ending&&!state.finished)endWritable(this,state,cb)};function needFinish(state){return state.ending&&state.length===0&&state.bufferedRequest===null&&!state.finished&&!state.writing}function prefinish(stream,state){if(!state.prefinished){state.prefinished=true;stream.emit("prefinish")}}function finishMaybe(stream,state){var need=needFinish(state);if(need){if(state.pendingcb===0){prefinish(stream,state);state.finished=true;stream.emit("finish")}else{prefinish(stream,state)}}return need}function endWritable(stream,state,cb){state.ending=true;finishMaybe(stream,state);if(cb){if(state.finished)processNextTick(cb);else stream.once("finish",cb)}state.ended=true}},{"./_stream_duplex":29,buffer:15,"core-util-is":34,events:19,inherits:21,"process-nextick-args":35,"util-deprecate":36}],34:[function(require,module,exports){(function(Buffer){function isArray(ar){return Array.isArray(ar)}exports.isArray=isArray;function isBoolean(arg){return typeof arg==="boolean"}exports.isBoolean=isBoolean;function isNull(arg){return arg===null}exports.isNull=isNull;function isNullOrUndefined(arg){return arg==null}exports.isNullOrUndefined=isNullOrUndefined;function isNumber(arg){return typeof arg==="number"}exports.isNumber=isNumber;function isString(arg){return typeof arg==="string"}exports.isString=isString;function isSymbol(arg){return typeof arg==="symbol"}exports.isSymbol=isSymbol;function isUndefined(arg){return arg===void 0}exports.isUndefined=isUndefined;function isRegExp(re){return isObject(re)&&objectToString(re)==="[object RegExp]"}exports.isRegExp=isRegExp;function isObject(arg){return typeof arg==="object"&&arg!==null}exports.isObject=isObject;function isDate(d){return isObject(d)&&objectToString(d)==="[object Date]"}exports.isDate=isDate;function isError(e){return isObject(e)&&(objectToString(e)==="[object Error]"||e instanceof Error)}exports.isError=isError;function isFunction(arg){return typeof arg==="function"}exports.isFunction=isFunction;function isPrimitive(arg){return arg===null||typeof arg==="boolean"||typeof arg==="number"||typeof arg==="string"||typeof arg==="symbol"||typeof arg==="undefined"}exports.isPrimitive=isPrimitive;function isBuffer(arg){return Buffer.isBuffer(arg)}exports.isBuffer=isBuffer;function objectToString(o){return Object.prototype.toString.call(o)}}).call(this,require("buffer").Buffer)},{buffer:15}],35:[function(require,module,exports){(function(process){"use strict";module.exports=nextTick;function nextTick(fn){var args=new Array(arguments.length-1);var i=0;while(i<arguments.length){args[i++]=arguments[i]}process.nextTick(function afterTick(){fn.apply(null,args)})}}).call(this,require("_process"))},{_process:23}],36:[function(require,module,exports){(function(global){module.exports=deprecate;function deprecate(fn,msg){if(config("noDeprecation")){return fn}var warned=false;function deprecated(){if(!warned){if(config("throwDeprecation")){throw new Error(msg)}else if(config("traceDeprecation")){console.trace(msg)}else{console.warn(msg)}warned=true}return fn.apply(this,arguments)}return deprecated}function config(name){if(!global.localStorage)return false;var val=global.localStorage[name];if(null==val)return false;return String(val).toLowerCase()==="true"}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],37:[function(require,module,exports){module.exports=require("./lib/_stream_passthrough.js")},{"./lib/_stream_passthrough.js":30}],38:[function(require,module,exports){var Stream=function(){try{return require("st"+"ream")}catch(_){}}();exports=module.exports=require("./lib/_stream_readable.js");exports.Stream=Stream||exports;exports.Readable=exports;exports.Writable=require("./lib/_stream_writable.js");exports.Duplex=require("./lib/_stream_duplex.js");exports.Transform=require("./lib/_stream_transform.js");exports.PassThrough=require("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":29,"./lib/_stream_passthrough.js":30,"./lib/_stream_readable.js":31,"./lib/_stream_transform.js":32,"./lib/_stream_writable.js":33}],39:[function(require,module,exports){module.exports=require("./lib/_stream_transform.js")},{"./lib/_stream_transform.js":32}],40:[function(require,module,exports){module.exports=require("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":33}],41:[function(require,module,exports){module.exports=Stream;var EE=require("events").EventEmitter;var inherits=require("inherits");inherits(Stream,EE);Stream.Readable=require("readable-stream/readable.js");Stream.Writable=require("readable-stream/writable.js");Stream.Duplex=require("readable-stream/duplex.js");Stream.Transform=require("readable-stream/transform.js");Stream.PassThrough=require("readable-stream/passthrough.js");Stream.Stream=Stream;function Stream(){EE.call(this)}Stream.prototype.pipe=function(dest,options){var source=this;function ondata(chunk){if(dest.writable){if(false===dest.write(chunk)&&source.pause){source.pause()}}}source.on("data",ondata);function ondrain(){if(source.readable&&source.resume){source.resume()}}dest.on("drain",ondrain);if(!dest._isStdio&&(!options||options.end!==false)){source.on("end",onend);source.on("close",onclose)}var didOnEnd=false;function onend(){if(didOnEnd)return;didOnEnd=true;dest.end()}function onclose(){if(didOnEnd)return;didOnEnd=true;if(typeof dest.destroy==="function")dest.destroy()}function onerror(er){cleanup();if(EE.listenerCount(this,"error")===0){throw er}}source.on("error",onerror);dest.on("error",onerror);function cleanup(){source.removeListener("data",ondata);dest.removeListener("drain",ondrain);source.removeListener("end",onend);source.removeListener("close",onclose);source.removeListener("error",onerror);dest.removeListener("error",onerror);source.removeListener("end",cleanup);source.removeListener("close",cleanup);dest.removeListener("close",cleanup)}source.on("end",cleanup);source.on("close",cleanup);dest.on("close",cleanup);dest.emit("pipe",source);return dest}},{events:19,inherits:21,"readable-stream/duplex.js":28,"readable-stream/passthrough.js":37,"readable-stream/readable.js":38,"readable-stream/transform.js":39,"readable-stream/writable.js":40}],42:[function(require,module,exports){var ClientRequest=require("./lib/request");var extend=require("xtend");var statusCodes=require("builtin-status-codes");var url=require("url");var http=exports;http.request=function(opts,cb){if(typeof opts==="string")opts=url.parse(opts);else opts=extend(opts);var hostHostname=opts.host?opts.host.split(":")[0]:null;var hostPort=opts.host?parseInt(opts.host.split(":")[1],10):null;opts.method=opts.method||"GET";opts.headers=opts.headers||{};opts.path=opts.path||"/";opts.protocol=opts.protocol||window.location.protocol;var defaultPort=opts.hostname||hostHostname?opts.protocol==="https:"?443:80:window.location.port;opts.hostname=opts.hostname||hostHostname||window.location.hostname;opts.port=opts.port||hostPort||defaultPort;var req=new ClientRequest(opts);if(cb)req.on("response",cb);return req};http.get=function get(opts,cb){var req=http.request(opts,cb);req.end();return req};http.Agent=function(){};http.Agent.defaultMaxSockets=4;http.STATUS_CODES=statusCodes;http.METHODS=["GET","POST","PUT","DELETE"]},{"./lib/request":44,"builtin-status-codes":46,url:52,xtend:53}],43:[function(require,module,exports){exports.fetch=isFunction(window.fetch)&&isFunction(window.ReadableByteStream);exports.blobConstructor=false;try{new Blob([new ArrayBuffer(1)]);exports.blobConstructor=true}catch(e){}var xhr=new window.XMLHttpRequest;xhr.open("GET","/");function checkTypeSupport(type){try{xhr.responseType=type;return xhr.responseType===type}catch(e){}return false}var haveArrayBuffer=isFunction(window.ArrayBuffer);var haveSlice=haveArrayBuffer&&isFunction(window.ArrayBuffer.prototype.slice);exports.arraybuffer=haveArrayBuffer&&checkTypeSupport("arraybuffer");exports.msstream=haveSlice&&checkTypeSupport("ms-stream");exports.mozchunkedarraybuffer=haveArrayBuffer&&checkTypeSupport("moz-chunked-arraybuffer");exports.overrideMimeType=isFunction(xhr.overrideMimeType);exports.vbArray=isFunction(window.VBArray);function isFunction(value){return typeof value==="function"}xhr=null},{}],44:[function(require,module,exports){(function(process,Buffer){var capability=require("./capability");var foreach=require("foreach");var indexOf=require("indexof");var inherits=require("inherits");var keys=require("object-keys");var response=require("./response");var stream=require("stream");var IncomingMessage=response.IncomingMessage;var rStates=response.readyStates;function decideMode(preferBinary){if(capability.fetch){return"fetch"}else if(capability.mozchunkedarraybuffer){return"moz-chunked-arraybuffer"}else if(capability.msstream){return"ms-stream"}else if(capability.arraybuffer&&preferBinary){return"arraybuffer"}else if(capability.vbArray&&preferBinary){return"text:vbarray"}else{return"text"}}var ClientRequest=module.exports=function(opts){var self=this;stream.Writable.call(self);self._opts=opts;self._url=opts.protocol+"//"+opts.hostname+":"+opts.port+opts.path;self._body=[];self._headers={};if(opts.auth)self.setHeader("Authorization","Basic "+new Buffer(opts.auth).toString("base64"));foreach(keys(opts.headers),function(name){self.setHeader(name,opts.headers[name])});var preferBinary;if(opts.mode==="prefer-streaming"){preferBinary=false}else if(opts.mode==="prefer-fast"){preferBinary=true}else if(!opts.mode||opts.mode==="default"){preferBinary=!capability.overrideMimeType}else{throw new Error("Invalid value for opts.mode")}self._mode=decideMode(preferBinary);self.on("finish",function(){self._onFinish()})};inherits(ClientRequest,stream.Writable);ClientRequest.prototype.setHeader=function(name,value){var self=this;var lowerName=name.toLowerCase();if(indexOf(unsafeHeaders,lowerName)!==-1)return;self._headers[lowerName]={name:name,value:value}};ClientRequest.prototype.getHeader=function(name){var self=this;return self._headers[name.toLowerCase()].value};ClientRequest.prototype.removeHeader=function(name){var self=this;delete self._headers[name.toLowerCase()]};ClientRequest.prototype._onFinish=function(){var self=this;if(self._destroyed)return;var opts=self._opts;var headersObj=self._headers;var body;if(opts.method==="POST"||opts.method==="PUT"){if(capability.blobConstructor){body=new window.Blob(self._body.map(function(buffer){return buffer.toArrayBuffer()}),{type:(headersObj["content-type"]||{}).value||""})}else{body=Buffer.concat(self._body).toString()}}if(self._mode==="fetch"){var headers=keys(headersObj).map(function(name){return[headersObj[name].name,headersObj[name].value]});window.fetch(self._url,{method:self._opts.method,headers:headers,body:body,mode:"cors",credentials:opts.withCredentials?"include":"same-origin"}).then(function(response){self._fetchResponse=response;self._connect()}).then(undefined,function(reason){self.emit("error",reason)})}else{var xhr=self._xhr=new window.XMLHttpRequest;try{xhr.open(self._opts.method,self._url,true)}catch(err){process.nextTick(function(){self.emit("error",err)});return}if("responseType"in xhr)xhr.responseType=self._mode.split(":")[0];if("withCredentials"in xhr)xhr.withCredentials=!!opts.withCredentials;if(self._mode==="text"&&"overrideMimeType"in xhr)xhr.overrideMimeType("text/plain; charset=x-user-defined");foreach(keys(headersObj),function(name){xhr.setRequestHeader(headersObj[name].name,headersObj[name].value)});self._response=null;xhr.onreadystatechange=function(){switch(xhr.readyState){case rStates.LOADING:case rStates.DONE:self._onXHRProgress();break}};if(self._mode==="moz-chunked-arraybuffer"){xhr.onprogress=function(){self._onXHRProgress()}}xhr.onerror=function(){if(self._destroyed)return;self.emit("error",new Error("XHR error"))};try{xhr.send(body)}catch(err){process.nextTick(function(){self.emit("error",err)});return}}};function statusValid(xhr){try{return xhr.status!==null}catch(e){return false}}ClientRequest.prototype._onXHRProgress=function(){var self=this;if(!statusValid(self._xhr)||self._destroyed)return;if(!self._response)self._connect();self._response._onXHRProgress()};ClientRequest.prototype._connect=function(){var self=this;if(self._destroyed)return;self._response=new IncomingMessage(self._xhr,self._fetchResponse,self._mode);self.emit("response",self._response)};ClientRequest.prototype._write=function(chunk,encoding,cb){var self=this;self._body.push(chunk);cb()};ClientRequest.prototype.abort=ClientRequest.prototype.destroy=function(){var self=this;self._destroyed=true;if(self._response)self._response._destroyed=true;if(self._xhr)self._xhr.abort()};ClientRequest.prototype.end=function(data,encoding,cb){var self=this;if(typeof data==="function"){cb=data;data=undefined}if(data)stream.Writable.push.call(self,data,encoding);stream.Writable.prototype.end.call(self,cb)};ClientRequest.prototype.flushHeaders=function(){};ClientRequest.prototype.setTimeout=function(){};ClientRequest.prototype.setNoDelay=function(){};ClientRequest.prototype.setSocketKeepAlive=function(){};var unsafeHeaders=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"]}).call(this,require("_process"),require("buffer").Buffer)},{"./capability":43,"./response":45,_process:23,buffer:15,foreach:47,indexof:48,inherits:21,"object-keys":49,stream:41}],45:[function(require,module,exports){(function(process,Buffer){var capability=require("./capability");var foreach=require("foreach");var inherits=require("inherits");var stream=require("stream");var rStates=exports.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4};var IncomingMessage=exports.IncomingMessage=function(xhr,response,mode){var self=this;stream.Readable.call(self);self._mode=mode;self.headers={};self.rawHeaders=[];self.trailers={};self.rawTrailers=[];self.on("end",function(){process.nextTick(function(){self.emit("close")})});if(mode==="fetch"){self._fetchResponse=response;self.statusCode=response.status;self.statusMessage=response.statusText;for(var header,_i,_it=response.headers[Symbol.iterator]();header=(_i=_it.next()).value,!_i.done;){self.headers[header[0].toLowerCase()]=header[1];self.rawHeaders.push(header[0],header[1])}var reader=response.body.getReader();function read(){reader.read().then(function(result){if(self._destroyed)return;if(result.done){self.push(null);return}self.push(new Buffer(result.value));read()})}read()}else{self._xhr=xhr;self._pos=0;self.statusCode=xhr.status;self.statusMessage=xhr.statusText;var headers=xhr.getAllResponseHeaders().split(/\r?\n/);foreach(headers,function(header){var matches=header.match(/^([^:]+):\s*(.*)/);if(matches){var key=matches[1].toLowerCase();if(self.headers[key]!==undefined)self.headers[key]+=", "+matches[2];else self.headers[key]=matches[2];self.rawHeaders.push(matches[1],matches[2])}});self._charset="x-user-defined";if(!capability.overrideMimeType){var mimeType=self.rawHeaders["mime-type"];if(mimeType){var charsetMatch=mimeType.match(/;\s*charset=([^;])(;|$)/);if(charsetMatch){self._charset=charsetMatch[1].toLowerCase()}}if(!self._charset)self._charset="utf-8"}}};inherits(IncomingMessage,stream.Readable);IncomingMessage.prototype._read=function(){};IncomingMessage.prototype._onXHRProgress=function(){var self=this;var xhr=self._xhr;var response=null;switch(self._mode){case"text:vbarray":if(xhr.readyState!==rStates.DONE)break;try{response=new window.VBArray(xhr.responseBody).toArray()}catch(e){}if(response!==null){self.push(new Buffer(response));break}case"text":try{response=xhr.responseText}catch(e){self._mode="text:vbarray";break}if(response.length>self._pos){var newData=response.substr(self._pos);if(self._charset==="x-user-defined"){var buffer=new Buffer(newData.length);for(var i=0;i<newData.length;i++)buffer[i]=newData.charCodeAt(i)&255;self.push(buffer)}else{self.push(newData,self._charset)}self._pos=response.length}break;case"arraybuffer":if(xhr.readyState!==rStates.DONE)break;response=xhr.response;self.push(new Buffer(new Uint8Array(response)));break;case"moz-chunked-arraybuffer":response=xhr.response;if(xhr.readyState!==rStates.LOADING||!response)break;self.push(new Buffer(new Uint8Array(response)));break;case"ms-stream":response=xhr.response;if(xhr.readyState!==rStates.LOADING)break;var reader=new window.MSStreamReader;reader.onprogress=function(){if(reader.result.byteLength>self._pos){self.push(new Buffer(new Uint8Array(reader.result.slice(self._pos))));self._pos=reader.result.byteLength}};reader.onload=function(){self.push(null)};reader.readAsArrayBuffer(response);break}if(self._xhr.readyState===rStates.DONE&&self._mode!=="ms-stream"){self.push(null)}}}).call(this,require("_process"),require("buffer").Buffer)},{"./capability":43,_process:23,buffer:15,foreach:47,inherits:21,stream:41}],46:[function(require,module,exports){module.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Time-out",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Large",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Time-out",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{}],47:[function(require,module,exports){var hasOwn=Object.prototype.hasOwnProperty;var toString=Object.prototype.toString;module.exports=function forEach(obj,fn,ctx){if(toString.call(fn)!=="[object Function]"){throw new TypeError("iterator must be a function")}var l=obj.length;if(l===+l){for(var i=0;i<l;i++){fn.call(ctx,obj[i],i,obj)}}else{for(var k in obj){if(hasOwn.call(obj,k)){fn.call(ctx,obj[k],k,obj)}}}}},{}],48:[function(require,module,exports){var indexOf=[].indexOf;module.exports=function(arr,obj){if(indexOf)return arr.indexOf(obj);for(var i=0;i<arr.length;++i){if(arr[i]===obj)return i}return-1}},{}],49:[function(require,module,exports){"use strict";var has=Object.prototype.hasOwnProperty;var toStr=Object.prototype.toString;var slice=Array.prototype.slice;var isArgs=require("./isArguments");var hasDontEnumBug=!{toString:null}.propertyIsEnumerable("toString");var hasProtoEnumBug=function(){}.propertyIsEnumerable("prototype");var dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];var keysShim=function keys(object){var isObject=object!==null&&typeof object==="object";var isFunction=toStr.call(object)==="[object Function]";var isArguments=isArgs(object);var isString=isObject&&toStr.call(object)==="[object String]";var theKeys=[];if(!isObject&&!isFunction&&!isArguments){throw new TypeError("Object.keys called on a non-object")}var skipProto=hasProtoEnumBug&&isFunction;if(isString&&object.length>0&&!has.call(object,0)){for(var i=0;i<object.length;++i){theKeys.push(String(i))}}if(isArguments&&object.length>0){for(var j=0;j<object.length;++j){theKeys.push(String(j))}}else{for(var name in object){if(!(skipProto&&name==="prototype")&&has.call(object,name)){theKeys.push(String(name))}}}if(hasDontEnumBug){var ctor=object.constructor;var skipConstructor=ctor&&ctor.prototype===object;for(var k=0;k<dontEnums.length;++k){if(!(skipConstructor&&dontEnums[k]==="constructor")&&has.call(object,dontEnums[k])){theKeys.push(dontEnums[k])}}}return theKeys};keysShim.shim=function shimObjectKeys(){if(!Object.keys){Object.keys=keysShim}else{var keysWorksWithArguments=function(){return(Object.keys(arguments)||"").length===2}(1,2);if(!keysWorksWithArguments){var originalKeys=Object.keys;Object.keys=function keys(object){if(isArgs(object)){return originalKeys(slice.call(object))}else{return originalKeys(object)}}}}return Object.keys||keysShim};module.exports=keysShim},{"./isArguments":50}],50:[function(require,module,exports){"use strict";var toStr=Object.prototype.toString;module.exports=function isArguments(value){var str=toStr.call(value);var isArgs=str==="[object Arguments]";if(!isArgs){isArgs=str!=="[object Array]"&&value!==null&&typeof value==="object"&&typeof value.length==="number"&&value.length>=0&&toStr.call(value.callee)==="[object Function]"}return isArgs}},{}],51:[function(require,module,exports){var Buffer=require("buffer").Buffer;var isBufferEncoding=Buffer.isEncoding||function(encoding){switch(encoding&&encoding.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return true;default:return false}};function assertEncoding(encoding){if(encoding&&!isBufferEncoding(encoding)){throw new Error("Unknown encoding: "+encoding)}}var StringDecoder=exports.StringDecoder=function(encoding){this.encoding=(encoding||"utf8").toLowerCase().replace(/[-_]/,"");assertEncoding(encoding);switch(this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2;this.detectIncompleteChar=utf16DetectIncompleteChar;break;case"base64":this.surrogateSize=3;this.detectIncompleteChar=base64DetectIncompleteChar;break;default:this.write=passThroughWrite;return}this.charBuffer=new Buffer(6);this.charReceived=0;this.charLength=0};StringDecoder.prototype.write=function(buffer){var charStr="";while(this.charLength){var available=buffer.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:buffer.length;buffer.copy(this.charBuffer,this.charReceived,0,available);this.charReceived+=available;if(this.charReceived<this.charLength){return""}buffer=buffer.slice(available,buffer.length);charStr=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var charCode=charStr.charCodeAt(charStr.length-1);if(charCode>=55296&&charCode<=56319){this.charLength+=this.surrogateSize;charStr="";continue}this.charReceived=this.charLength=0;if(buffer.length===0){return charStr}break}this.detectIncompleteChar(buffer);var end=buffer.length;if(this.charLength){buffer.copy(this.charBuffer,0,buffer.length-this.charReceived,end);end-=this.charReceived}charStr+=buffer.toString(this.encoding,0,end);var end=charStr.length-1;var charCode=charStr.charCodeAt(end);if(charCode>=55296&&charCode<=56319){var size=this.surrogateSize;this.charLength+=size;this.charReceived+=size;this.charBuffer.copy(this.charBuffer,size,0,size);buffer.copy(this.charBuffer,0,0,size);return charStr.substring(0,end)}return charStr};StringDecoder.prototype.detectIncompleteChar=function(buffer){var i=buffer.length>=3?3:buffer.length;for(;i>0;i--){var c=buffer[buffer.length-i];if(i==1&&c>>5==6){this.charLength=2;break}if(i<=2&&c>>4==14){this.charLength=3;break}if(i<=3&&c>>3==30){this.charLength=4;break}}this.charReceived=i};StringDecoder.prototype.end=function(buffer){var res="";if(buffer&&buffer.length)res=this.write(buffer);if(this.charReceived){var cr=this.charReceived;var buf=this.charBuffer;var enc=this.encoding;res+=buf.slice(0,cr).toString(enc)}return res};function passThroughWrite(buffer){return buffer.toString(this.encoding)}function utf16DetectIncompleteChar(buffer){this.charReceived=buffer.length%2;this.charLength=this.charReceived?2:0}function base64DetectIncompleteChar(buffer){this.charReceived=buffer.length%3;this.charLength=this.charReceived?3:0}},{buffer:15}],52:[function(require,module,exports){var punycode=require("punycode");exports.parse=urlParse;exports.resolve=urlResolve;exports.resolveObject=urlResolveObject;exports.format=urlFormat;exports.Url=Url;function Url(){this.protocol=null;this.slashes=null;this.auth=null;this.host=null;this.port=null;this.hostname=null;this.hash=null;this.search=null;this.query=null;this.pathname=null;this.path=null;this.href=null}var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,delims=["<",">",'"',"`"," ","\r","\n","	"],unwise=["{","}","|","\\","^","`"].concat(delims),autoEscape=["'"].concat(unwise),nonHostChars=["%","/","?",";","#"].concat(autoEscape),hostEndingChars=["/","?","#"],hostnameMaxLen=255,hostnamePartPattern=/^[a-z0-9A-Z_-]{0,63}$/,hostnamePartStart=/^([a-z0-9A-Z_-]{0,63})(.*)$/,unsafeProtocol={javascript:true,"javascript:":true},hostlessProtocol={javascript:true,"javascript:":true},slashedProtocol={http:true,https:true,ftp:true,gopher:true,file:true,"http:":true,"https:":true,"ftp:":true,"gopher:":true,"file:":true},querystring=require("querystring");function urlParse(url,parseQueryString,slashesDenoteHost){if(url&&isObject(url)&&url instanceof Url)return url;var u=new Url;u.parse(url,parseQueryString,slashesDenoteHost);return u}Url.prototype.parse=function(url,parseQueryString,slashesDenoteHost){if(!isString(url)){throw new TypeError("Parameter 'url' must be a string, not "+typeof url)}var rest=url;rest=rest.trim();var proto=protocolPattern.exec(rest);if(proto){proto=proto[0];var lowerProto=proto.toLowerCase();this.protocol=lowerProto;rest=rest.substr(proto.length)}if(slashesDenoteHost||proto||rest.match(/^\/\/[^@\/]+@[^@\/]+/)){var slashes=rest.substr(0,2)==="//";if(slashes&&!(proto&&hostlessProtocol[proto])){rest=rest.substr(2);this.slashes=true}}if(!hostlessProtocol[proto]&&(slashes||proto&&!slashedProtocol[proto])){var hostEnd=-1;for(var i=0;i<hostEndingChars.length;i++){var hec=rest.indexOf(hostEndingChars[i]);if(hec!==-1&&(hostEnd===-1||hec<hostEnd))hostEnd=hec}var auth,atSign;if(hostEnd===-1){atSign=rest.lastIndexOf("@")}else{atSign=rest.lastIndexOf("@",hostEnd)}if(atSign!==-1){auth=rest.slice(0,atSign);rest=rest.slice(atSign+1);this.auth=decodeURIComponent(auth)}hostEnd=-1;for(var i=0;i<nonHostChars.length;i++){var hec=rest.indexOf(nonHostChars[i]);if(hec!==-1&&(hostEnd===-1||hec<hostEnd))hostEnd=hec}if(hostEnd===-1)hostEnd=rest.length;this.host=rest.slice(0,hostEnd);rest=rest.slice(hostEnd);this.parseHost();this.hostname=this.hostname||"";var ipv6Hostname=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!ipv6Hostname){var hostparts=this.hostname.split(/\./);for(var i=0,l=hostparts.length;i<l;i++){var part=hostparts[i];if(!part)continue;if(!part.match(hostnamePartPattern)){
var newpart="";for(var j=0,k=part.length;j<k;j++){if(part.charCodeAt(j)>127){newpart+="x"}else{newpart+=part[j]}}if(!newpart.match(hostnamePartPattern)){var validParts=hostparts.slice(0,i);var notHost=hostparts.slice(i+1);var bit=part.match(hostnamePartStart);if(bit){validParts.push(bit[1]);notHost.unshift(bit[2])}if(notHost.length){rest="/"+notHost.join(".")+rest}this.hostname=validParts.join(".");break}}}}if(this.hostname.length>hostnameMaxLen){this.hostname=""}else{this.hostname=this.hostname.toLowerCase()}if(!ipv6Hostname){var domainArray=this.hostname.split(".");var newOut=[];for(var i=0;i<domainArray.length;++i){var s=domainArray[i];newOut.push(s.match(/[^A-Za-z0-9_-]/)?"xn--"+punycode.encode(s):s)}this.hostname=newOut.join(".")}var p=this.port?":"+this.port:"";var h=this.hostname||"";this.host=h+p;this.href+=this.host;if(ipv6Hostname){this.hostname=this.hostname.substr(1,this.hostname.length-2);if(rest[0]!=="/"){rest="/"+rest}}}if(!unsafeProtocol[lowerProto]){for(var i=0,l=autoEscape.length;i<l;i++){var ae=autoEscape[i];var esc=encodeURIComponent(ae);if(esc===ae){esc=escape(ae)}rest=rest.split(ae).join(esc)}}var hash=rest.indexOf("#");if(hash!==-1){this.hash=rest.substr(hash);rest=rest.slice(0,hash)}var qm=rest.indexOf("?");if(qm!==-1){this.search=rest.substr(qm);this.query=rest.substr(qm+1);if(parseQueryString){this.query=querystring.parse(this.query)}rest=rest.slice(0,qm)}else if(parseQueryString){this.search="";this.query={}}if(rest)this.pathname=rest;if(slashedProtocol[lowerProto]&&this.hostname&&!this.pathname){this.pathname="/"}if(this.pathname||this.search){var p=this.pathname||"";var s=this.search||"";this.path=p+s}this.href=this.format();return this};function urlFormat(obj){if(isString(obj))obj=urlParse(obj);if(!(obj instanceof Url))return Url.prototype.format.call(obj);return obj.format()}Url.prototype.format=function(){var auth=this.auth||"";if(auth){auth=encodeURIComponent(auth);auth=auth.replace(/%3A/i,":");auth+="@"}var protocol=this.protocol||"",pathname=this.pathname||"",hash=this.hash||"",host=false,query="";if(this.host){host=auth+this.host}else if(this.hostname){host=auth+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]");if(this.port){host+=":"+this.port}}if(this.query&&isObject(this.query)&&Object.keys(this.query).length){query=querystring.stringify(this.query)}var search=this.search||query&&"?"+query||"";if(protocol&&protocol.substr(-1)!==":")protocol+=":";if(this.slashes||(!protocol||slashedProtocol[protocol])&&host!==false){host="//"+(host||"");if(pathname&&pathname.charAt(0)!=="/")pathname="/"+pathname}else if(!host){host=""}if(hash&&hash.charAt(0)!=="#")hash="#"+hash;if(search&&search.charAt(0)!=="?")search="?"+search;pathname=pathname.replace(/[?#]/g,function(match){return encodeURIComponent(match)});search=search.replace("#","%23");return protocol+host+pathname+search+hash};function urlResolve(source,relative){return urlParse(source,false,true).resolve(relative)}Url.prototype.resolve=function(relative){return this.resolveObject(urlParse(relative,false,true)).format()};function urlResolveObject(source,relative){if(!source)return relative;return urlParse(source,false,true).resolveObject(relative)}Url.prototype.resolveObject=function(relative){if(isString(relative)){var rel=new Url;rel.parse(relative,false,true);relative=rel}var result=new Url;Object.keys(this).forEach(function(k){result[k]=this[k]},this);result.hash=relative.hash;if(relative.href===""){result.href=result.format();return result}if(relative.slashes&&!relative.protocol){Object.keys(relative).forEach(function(k){if(k!=="protocol")result[k]=relative[k]});if(slashedProtocol[result.protocol]&&result.hostname&&!result.pathname){result.path=result.pathname="/"}result.href=result.format();return result}if(relative.protocol&&relative.protocol!==result.protocol){if(!slashedProtocol[relative.protocol]){Object.keys(relative).forEach(function(k){result[k]=relative[k]});result.href=result.format();return result}result.protocol=relative.protocol;if(!relative.host&&!hostlessProtocol[relative.protocol]){var relPath=(relative.pathname||"").split("/");while(relPath.length&&!(relative.host=relPath.shift()));if(!relative.host)relative.host="";if(!relative.hostname)relative.hostname="";if(relPath[0]!=="")relPath.unshift("");if(relPath.length<2)relPath.unshift("");result.pathname=relPath.join("/")}else{result.pathname=relative.pathname}result.search=relative.search;result.query=relative.query;result.host=relative.host||"";result.auth=relative.auth;result.hostname=relative.hostname||relative.host;result.port=relative.port;if(result.pathname||result.search){var p=result.pathname||"";var s=result.search||"";result.path=p+s}result.slashes=result.slashes||relative.slashes;result.href=result.format();return result}var isSourceAbs=result.pathname&&result.pathname.charAt(0)==="/",isRelAbs=relative.host||relative.pathname&&relative.pathname.charAt(0)==="/",mustEndAbs=isRelAbs||isSourceAbs||result.host&&relative.pathname,removeAllDots=mustEndAbs,srcPath=result.pathname&&result.pathname.split("/")||[],relPath=relative.pathname&&relative.pathname.split("/")||[],psychotic=result.protocol&&!slashedProtocol[result.protocol];if(psychotic){result.hostname="";result.port=null;if(result.host){if(srcPath[0]==="")srcPath[0]=result.host;else srcPath.unshift(result.host)}result.host="";if(relative.protocol){relative.hostname=null;relative.port=null;if(relative.host){if(relPath[0]==="")relPath[0]=relative.host;else relPath.unshift(relative.host)}relative.host=null}mustEndAbs=mustEndAbs&&(relPath[0]===""||srcPath[0]==="")}if(isRelAbs){result.host=relative.host||relative.host===""?relative.host:result.host;result.hostname=relative.hostname||relative.hostname===""?relative.hostname:result.hostname;result.search=relative.search;result.query=relative.query;srcPath=relPath}else if(relPath.length){if(!srcPath)srcPath=[];srcPath.pop();srcPath=srcPath.concat(relPath);result.search=relative.search;result.query=relative.query}else if(!isNullOrUndefined(relative.search)){if(psychotic){result.hostname=result.host=srcPath.shift();var authInHost=result.host&&result.host.indexOf("@")>0?result.host.split("@"):false;if(authInHost){result.auth=authInHost.shift();result.host=result.hostname=authInHost.shift()}}result.search=relative.search;result.query=relative.query;if(!isNull(result.pathname)||!isNull(result.search)){result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")}result.href=result.format();return result}if(!srcPath.length){result.pathname=null;if(result.search){result.path="/"+result.search}else{result.path=null}result.href=result.format();return result}var last=srcPath.slice(-1)[0];var hasTrailingSlash=(result.host||relative.host)&&(last==="."||last==="..")||last==="";var up=0;for(var i=srcPath.length;i>=0;i--){last=srcPath[i];if(last=="."){srcPath.splice(i,1)}else if(last===".."){srcPath.splice(i,1);up++}else if(up){srcPath.splice(i,1);up--}}if(!mustEndAbs&&!removeAllDots){for(;up--;up){srcPath.unshift("..")}}if(mustEndAbs&&srcPath[0]!==""&&(!srcPath[0]||srcPath[0].charAt(0)!=="/")){srcPath.unshift("")}if(hasTrailingSlash&&srcPath.join("/").substr(-1)!=="/"){srcPath.push("")}var isAbsolute=srcPath[0]===""||srcPath[0]&&srcPath[0].charAt(0)==="/";if(psychotic){result.hostname=result.host=isAbsolute?"":srcPath.length?srcPath.shift():"";var authInHost=result.host&&result.host.indexOf("@")>0?result.host.split("@"):false;if(authInHost){result.auth=authInHost.shift();result.host=result.hostname=authInHost.shift()}}mustEndAbs=mustEndAbs||result.host&&srcPath.length;if(mustEndAbs&&!isAbsolute){srcPath.unshift("")}if(!srcPath.length){result.pathname=null;result.path=null}else{result.pathname=srcPath.join("/")}if(!isNull(result.pathname)||!isNull(result.search)){result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")}result.auth=relative.auth||result.auth;result.slashes=result.slashes||relative.slashes;result.href=result.format();return result};Url.prototype.parseHost=function(){var host=this.host;var port=portPattern.exec(host);if(port){port=port[0];if(port!==":"){this.port=port.substr(1)}host=host.substr(0,host.length-port.length)}if(host)this.hostname=host};function isString(arg){return typeof arg==="string"}function isObject(arg){return typeof arg==="object"&&arg!==null}function isNull(arg){return arg===null}function isNullOrUndefined(arg){return arg==null}},{punycode:24,querystring:27}],53:[function(require,module,exports){module.exports=extend;function extend(){var target={};for(var i=0;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(source.hasOwnProperty(key)){target[key]=source[key]}}}return target}},{}],54:[function(require,module,exports){var statuses=require("statuses");var inherits=require("inherits");function toIdentifier(str){return str.split(" ").map(function(token){return token.slice(0,1).toUpperCase()+token.slice(1)}).join("").replace(/[^ _0-9a-z]/gi,"")}exports=module.exports=function httpError(){var err;var msg;var status=500;var props={};for(var i=0;i<arguments.length;i++){var arg=arguments[i];if(arg instanceof Error){err=arg;status=err.status||err.statusCode||status;continue}switch(typeof arg){case"string":msg=arg;break;case"number":status=arg;break;case"object":props=arg;break}}if(typeof status!=="number"||!statuses[status]){status=500}var HttpError=exports[status];if(!err){err=HttpError?new HttpError(msg):new Error(msg||statuses[status]);Error.captureStackTrace(err,httpError)}if(!HttpError||!(err instanceof HttpError)){err.expose=status<500;err.status=err.statusCode=status}for(var key in props){if(key!=="status"&&key!=="statusCode"){err[key]=props[key]}}return err};var codes=statuses.codes.filter(function(num){return num>=400});codes.forEach(function(code){var name=toIdentifier(statuses[code]);var className=name.match(/Error$/)?name:name+"Error";if(code>=500){var ServerError=function ServerError(msg){var self=new Error(msg!=null?msg:statuses[code]);Error.captureStackTrace(self,ServerError);self.__proto__=ServerError.prototype;Object.defineProperty(self,"name",{enumerable:false,configurable:true,value:className,writable:true});return self};inherits(ServerError,Error);ServerError.prototype.status=ServerError.prototype.statusCode=code;ServerError.prototype.expose=false;exports[code]=exports[name]=ServerError;return}var ClientError=function ClientError(msg){var self=new Error(msg!=null?msg:statuses[code]);Error.captureStackTrace(self,ClientError);self.__proto__=ClientError.prototype;Object.defineProperty(self,"name",{enumerable:false,configurable:true,value:className,writable:true});return self};inherits(ClientError,Error);ClientError.prototype.status=ClientError.prototype.statusCode=code;ClientError.prototype.expose=true;exports[code]=exports[name]=ClientError;return});exports["I'mateapot"]=exports.ImATeapot},{inherits:55,statuses:57}],55:[function(require,module,exports){arguments[4][21][0].apply(exports,arguments)},{dup:21}],56:[function(require,module,exports){module.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"(Unused)",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{}],57:[function(require,module,exports){var codes=require("./codes.json");module.exports=status;status.codes=Object.keys(codes).map(function(code){code=~~code;var msg=codes[code];status[code]=msg;status[msg]=status[msg.toLowerCase()]=code;return code});status.redirect={300:true,301:true,302:true,303:true,305:true,307:true,308:true};status.empty={204:true,205:true,304:true};status.retry={502:true,503:true,504:true};function status(code){if(typeof code==="number"){if(!status[code])throw new Error("invalid status code: "+code);return code}if(typeof code!=="string"){throw new TypeError("code must be a number or string")}var n=parseInt(code,10);if(!isNaN(n)){if(!status[n])throw new Error("invalid status code: "+n);return n}n=status[code.toLowerCase()];if(!n)throw new Error('invalid status message: "'+code+'"');return n}},{"./codes.json":56}],58:[function(require,module,exports){(function(process){module.exports=process.env.LINKEDLIST_COV?require("./lib-cov/linkedlist"):require("./lib/linkedlist")}).call(this,require("_process"))},{"./lib-cov/linkedlist":59,"./lib/linkedlist":60,_process:23}],59:[function(require,module,exports){if(typeof _$jscoverage==="undefined")_$jscoverage={};if(!_$jscoverage["linkedlist.js"]){_$jscoverage["linkedlist.js"]=[];_$jscoverage["linkedlist.js"][1]=0;_$jscoverage["linkedlist.js"][2]=0;_$jscoverage["linkedlist.js"][8]=0;_$jscoverage["linkedlist.js"][14]=0;_$jscoverage["linkedlist.js"][20]=0;_$jscoverage["linkedlist.js"][28]=0;_$jscoverage["linkedlist.js"][29]=0;_$jscoverage["linkedlist.js"][32]=0;_$jscoverage["linkedlist.js"][33]=0;_$jscoverage["linkedlist.js"][36]=0;_$jscoverage["linkedlist.js"][37]=0;_$jscoverage["linkedlist.js"][40]=0;_$jscoverage["linkedlist.js"][41]=0;_$jscoverage["linkedlist.js"][44]=0;_$jscoverage["linkedlist.js"][45]=0;_$jscoverage["linkedlist.js"][46]=0;_$jscoverage["linkedlist.js"][47]=0;_$jscoverage["linkedlist.js"][48]=0;_$jscoverage["linkedlist.js"][49]=0;_$jscoverage["linkedlist.js"][51]=0;_$jscoverage["linkedlist.js"][54]=0;_$jscoverage["linkedlist.js"][55]=0;_$jscoverage["linkedlist.js"][56]=0;_$jscoverage["linkedlist.js"][57]=0;_$jscoverage["linkedlist.js"][59]=0;_$jscoverage["linkedlist.js"][60]=0;_$jscoverage["linkedlist.js"][61]=0;_$jscoverage["linkedlist.js"][62]=0;_$jscoverage["linkedlist.js"][64]=0;_$jscoverage["linkedlist.js"][65]=0;_$jscoverage["linkedlist.js"][66]=0;_$jscoverage["linkedlist.js"][67]=0;_$jscoverage["linkedlist.js"][68]=0;_$jscoverage["linkedlist.js"][70]=0;_$jscoverage["linkedlist.js"][73]=0;_$jscoverage["linkedlist.js"][74]=0;_$jscoverage["linkedlist.js"][75]=0;_$jscoverage["linkedlist.js"][76]=0;_$jscoverage["linkedlist.js"][78]=0;_$jscoverage["linkedlist.js"][79]=0;_$jscoverage["linkedlist.js"][80]=0;_$jscoverage["linkedlist.js"][81]=0;_$jscoverage["linkedlist.js"][83]=0;_$jscoverage["linkedlist.js"][84]=0;_$jscoverage["linkedlist.js"][85]=0;_$jscoverage["linkedlist.js"][86]=0;_$jscoverage["linkedlist.js"][88]=0;_$jscoverage["linkedlist.js"][91]=0;_$jscoverage["linkedlist.js"][92]=0;_$jscoverage["linkedlist.js"][93]=0;_$jscoverage["linkedlist.js"][94]=0;_$jscoverage["linkedlist.js"][95]=0;_$jscoverage["linkedlist.js"][97]=0;_$jscoverage["linkedlist.js"][100]=0;_$jscoverage["linkedlist.js"][101]=0;_$jscoverage["linkedlist.js"][102]=0;_$jscoverage["linkedlist.js"][103]=0;_$jscoverage["linkedlist.js"][106]=0;_$jscoverage["linkedlist.js"][107]=0;_$jscoverage["linkedlist.js"][108]=0;_$jscoverage["linkedlist.js"][109]=0;_$jscoverage["linkedlist.js"][111]=0;_$jscoverage["linkedlist.js"][112]=0;_$jscoverage["linkedlist.js"][113]=0;_$jscoverage["linkedlist.js"][115]=0;_$jscoverage["linkedlist.js"][117]=0;_$jscoverage["linkedlist.js"][118]=0;_$jscoverage["linkedlist.js"][119]=0;_$jscoverage["linkedlist.js"][120]=0;_$jscoverage["linkedlist.js"][121]=0;_$jscoverage["linkedlist.js"][124]=0;_$jscoverage["linkedlist.js"][125]=0;_$jscoverage["linkedlist.js"][126]=0;_$jscoverage["linkedlist.js"][127]=0;_$jscoverage["linkedlist.js"][129]=0;_$jscoverage["linkedlist.js"][130]=0;_$jscoverage["linkedlist.js"][131]=0;_$jscoverage["linkedlist.js"][132]=0;_$jscoverage["linkedlist.js"][134]=0;_$jscoverage["linkedlist.js"][135]=0;_$jscoverage["linkedlist.js"][136]=0;_$jscoverage["linkedlist.js"][137]=0;_$jscoverage["linkedlist.js"][138]=0;_$jscoverage["linkedlist.js"][139]=0;_$jscoverage["linkedlist.js"][140]=0;_$jscoverage["linkedlist.js"][141]=0;_$jscoverage["linkedlist.js"][143]=0;_$jscoverage["linkedlist.js"][144]=0;_$jscoverage["linkedlist.js"][145]=0;_$jscoverage["linkedlist.js"][147]=0;_$jscoverage["linkedlist.js"][148]=0;_$jscoverage["linkedlist.js"][151]=0;_$jscoverage["linkedlist.js"][152]=0;_$jscoverage["linkedlist.js"][153]=0;_$jscoverage["linkedlist.js"][154]=0;_$jscoverage["linkedlist.js"][155]=0;_$jscoverage["linkedlist.js"][156]=0;_$jscoverage["linkedlist.js"][160]=0;_$jscoverage["linkedlist.js"][161]=0;_$jscoverage["linkedlist.js"][162]=0;_$jscoverage["linkedlist.js"][165]=0;_$jscoverage["linkedlist.js"][166]=0;_$jscoverage["linkedlist.js"][167]=0;_$jscoverage["linkedlist.js"][168]=0;_$jscoverage["linkedlist.js"][169]=0;_$jscoverage["linkedlist.js"][170]=0}_$jscoverage["linkedlist.js"][1]++;module.exports=function(){_$jscoverage["linkedlist.js"][2]++;Object.defineProperty(this,"_head",{value:undefined,writable:true,enumerable:false,configurable:false});_$jscoverage["linkedlist.js"][8]++;Object.defineProperty(this,"_tail",{value:undefined,writable:true,enumerable:false,configurable:false});_$jscoverage["linkedlist.js"][14]++;Object.defineProperty(this,"_next",{value:undefined,writable:true,enumerable:false,configurable:false});_$jscoverage["linkedlist.js"][20]++;Object.defineProperty(this,"_length",{value:0,writable:true,enumerable:false,configurable:false})};_$jscoverage["linkedlist.js"][28]++;module.exports.prototype.__defineGetter__("head",function(){_$jscoverage["linkedlist.js"][29]++;return this._head&&this._head.data});_$jscoverage["linkedlist.js"][32]++;module.exports.prototype.__defineGetter__("tail",function(){_$jscoverage["linkedlist.js"][33]++;return this._tail&&this._tail.data});_$jscoverage["linkedlist.js"][36]++;module.exports.prototype.__defineGetter__("current",function(){_$jscoverage["linkedlist.js"][37]++;return this._current&&this._current.data});_$jscoverage["linkedlist.js"][40]++;module.exports.prototype.__defineGetter__("length",function(){_$jscoverage["linkedlist.js"][41]++;return this._length});_$jscoverage["linkedlist.js"][44]++;module.exports.prototype.push=function(data){_$jscoverage["linkedlist.js"][45]++;this._tail=new Item(data,this._tail);_$jscoverage["linkedlist.js"][46]++;if(this._length===0){_$jscoverage["linkedlist.js"][47]++;this._head=this._tail;_$jscoverage["linkedlist.js"][48]++;this._current=this._head;_$jscoverage["linkedlist.js"][49]++;this._next=this._head}_$jscoverage["linkedlist.js"][51]++;this._length++};_$jscoverage["linkedlist.js"][54]++;module.exports.prototype.pop=function(){_$jscoverage["linkedlist.js"][55]++;var tail=this._tail;_$jscoverage["linkedlist.js"][56]++;if(this._length===0){_$jscoverage["linkedlist.js"][57]++;return}_$jscoverage["linkedlist.js"][59]++;this._length--;_$jscoverage["linkedlist.js"][60]++;if(this._length===0){_$jscoverage["linkedlist.js"][61]++;this._head=this._tail=this._current=this._next=undefined;_$jscoverage["linkedlist.js"][62]++;return tail.data}_$jscoverage["linkedlist.js"][64]++;this._tail=tail.prev;_$jscoverage["linkedlist.js"][65]++;this._tail.next=undefined;_$jscoverage["linkedlist.js"][66]++;if(this._current===tail){_$jscoverage["linkedlist.js"][67]++;this._current=this._tail;_$jscoverage["linkedlist.js"][68]++;this._next=undefined}_$jscoverage["linkedlist.js"][70]++;return tail.data};_$jscoverage["linkedlist.js"][73]++;module.exports.prototype.shift=function(){_$jscoverage["linkedlist.js"][74]++;var head=this._head;_$jscoverage["linkedlist.js"][75]++;if(this._length===0){_$jscoverage["linkedlist.js"][76]++;return}_$jscoverage["linkedlist.js"][78]++;this._length--;_$jscoverage["linkedlist.js"][79]++;if(this._length===0){_$jscoverage["linkedlist.js"][80]++;this._head=this._tail=this._current=this._next=undefined;_$jscoverage["linkedlist.js"][81]++;return head.data}_$jscoverage["linkedlist.js"][83]++;this._head=this._head.next;_$jscoverage["linkedlist.js"][84]++;if(this._current===head){_$jscoverage["linkedlist.js"][85]++;this._current=this._head;_$jscoverage["linkedlist.js"][86]++;this._next=this._current.next}_$jscoverage["linkedlist.js"][88]++;return head.data};_$jscoverage["linkedlist.js"][91]++;module.exports.prototype.unshift=function(data){_$jscoverage["linkedlist.js"][92]++;this._head=new Item(data,undefined,this._head);_$jscoverage["linkedlist.js"][93]++;if(this._length===0){_$jscoverage["linkedlist.js"][94]++;this._tail=this._head;_$jscoverage["linkedlist.js"][95]++;this._next=this._head}_$jscoverage["linkedlist.js"][97]++;this._length++};_$jscoverage["linkedlist.js"][100]++;module.exports.prototype.unshiftCurrent=function(){_$jscoverage["linkedlist.js"][101]++;var current=this._current;_$jscoverage["linkedlist.js"][102]++;if(current===this._head||this._length<2){_$jscoverage["linkedlist.js"][103]++;return current&&current.data}_$jscoverage["linkedlist.js"][106]++;if(current===this._tail){_$jscoverage["linkedlist.js"][107]++;this._tail=current.prev;_$jscoverage["linkedlist.js"][108]++;this._tail.next=undefined;_$jscoverage["linkedlist.js"][109]++;this._current=this._tail}else{_$jscoverage["linkedlist.js"][111]++;current.next.prev=current.prev;_$jscoverage["linkedlist.js"][112]++;current.prev.next=current.next;_$jscoverage["linkedlist.js"][113]++;this._current=current.prev}_$jscoverage["linkedlist.js"][115]++;this._next=this._current.next;_$jscoverage["linkedlist.js"][117]++;current.next=this._head;_$jscoverage["linkedlist.js"][118]++;current.prev=undefined;_$jscoverage["linkedlist.js"][119]++;this._head.prev=current;_$jscoverage["linkedlist.js"][120]++;this._head=current;_$jscoverage["linkedlist.js"][121]++;return current.data};_$jscoverage["linkedlist.js"][124]++;module.exports.prototype.removeCurrent=function(data){_$jscoverage["linkedlist.js"][125]++;var current=this._current;_$jscoverage["linkedlist.js"][126]++;if(this._length===0){_$jscoverage["linkedlist.js"][127]++;return}_$jscoverage["linkedlist.js"][129]++;this._length--;_$jscoverage["linkedlist.js"][130]++;if(this._length===0){_$jscoverage["linkedlist.js"][131]++;this._head=this._tail=this._current=this._next=undefined;_$jscoverage["linkedlist.js"][132]++;return current.data}_$jscoverage["linkedlist.js"][134]++;if(current===this._tail){_$jscoverage["linkedlist.js"][135]++;this._tail=current.prev;_$jscoverage["linkedlist.js"][136]++;this._tail.next=undefined;_$jscoverage["linkedlist.js"][137]++;this._current=this._tail}else{_$jscoverage["linkedlist.js"][138]++;if(current===this._head){_$jscoverage["linkedlist.js"][139]++;this._head=current.next;_$jscoverage["linkedlist.js"][140]++;this._head.prev=undefined;_$jscoverage["linkedlist.js"][141]++;this._current=this._head}else{_$jscoverage["linkedlist.js"][143]++;current.next.prev=current.prev;_$jscoverage["linkedlist.js"][144]++;current.prev.next=current.next;_$jscoverage["linkedlist.js"][145]++;this._current=current.prev}}_$jscoverage["linkedlist.js"][147]++;this._next=this._current.next;_$jscoverage["linkedlist.js"][148]++;return current.data};_$jscoverage["linkedlist.js"][151]++;module.exports.prototype.next=function(){_$jscoverage["linkedlist.js"][152]++;var next=this._next;_$jscoverage["linkedlist.js"][153]++;if(next!==undefined){_$jscoverage["linkedlist.js"][154]++;this._next=next.next;_$jscoverage["linkedlist.js"][155]++;this._current=next;_$jscoverage["linkedlist.js"][156]++;return next.data}};_$jscoverage["linkedlist.js"][160]++;module.exports.prototype.resetCursor=function(){_$jscoverage["linkedlist.js"][161]++;this._current=this._next=this._head;_$jscoverage["linkedlist.js"][162]++;return this};_$jscoverage["linkedlist.js"][165]++;function Item(data,prev,next){_$jscoverage["linkedlist.js"][166]++;this.next=next;_$jscoverage["linkedlist.js"][167]++;if(next){_$jscoverage["linkedlist.js"][167]++;next.prev=this}_$jscoverage["linkedlist.js"][168]++;this.prev=prev;_$jscoverage["linkedlist.js"][169]++;if(prev){_$jscoverage["linkedlist.js"][169]++;prev.next=this}_$jscoverage["linkedlist.js"][170]++;this.data=data}_$jscoverage["linkedlist.js"].source=["module.exports = function () {","  Object.defineProperty(this, '_head', {","    value: undefined,","    writable: true,","    enumerable: false,","    configurable: false","  })","  Object.defineProperty(this, '_tail', {","    value: undefined,","    writable: true,","    enumerable: false,","    configurable: false","  })","  Object.defineProperty(this, '_next', {","    value: undefined,","    writable: true,","    enumerable: false,","    configurable: false","  })","  Object.defineProperty(this, '_length', {","    value: 0,","    writable: true,","    enumerable: false,","    configurable: false","  })","}","","module.exports.prototype.__defineGetter__('head', function () {","  return this._head &amp;&amp; this._head.data","})","","module.exports.prototype.__defineGetter__('tail', function () {","  return this._tail &amp;&amp; this._tail.data","})","","module.exports.prototype.__defineGetter__('current', function () {","  return this._current &amp;&amp; this._current.data","})","","module.exports.prototype.__defineGetter__('length', function () {","  return this._length","})","","module.exports.prototype.push = function (data) {","  this._tail = new Item(data, this._tail)","  if (this._length === 0) {","    this._head = this._tail","    this._current = this._head","    this._next = this._head","  }","  this._length++","}","","module.exports.prototype.pop = function () {","  var tail = this._tail","  if (this._length === 0) {","    return","  }","  this._length--","  if (this._length === 0) {","    this._head = this._tail = this._current = this._next = undefined","    return tail.data","  }","  this._tail = tail.prev","  this._tail.next = undefined","  if (this._current === tail) {","    this._current = this._tail","    this._next = undefined","  }","  return tail.data","}","","module.exports.prototype.shift = function () {","  var head = this._head","  if (this._length === 0)  {","    return","  }","  this._length--","  if (this._length === 0) {","    this._head = this._tail = this._current = this._next = undefined","    return head.data","  }","  this._head = this._head.next","  if (this._current === head) {","    this._current = this._head","    this._next = this._current.next","  }","  return head.data","}","","module.exports.prototype.unshift = function (data) {","  this._head = new Item(data, undefined, this._head)","  if (this._length === 0)  {","    this._tail = this._head","    this._next = this._head","  }","  this._length++","}","","module.exports.prototype.unshiftCurrent = function () {","  var current = this._current","  if (current === this._head || this._length &lt; 2) {","    return current &amp;&amp; current.data","  }","  // remove","  if (current === this._tail) {","    this._tail = current.prev","    this._tail.next = undefined","    this._current = this._tail","  } else {","    current.next.prev = current.prev","    current.prev.next = current.next","    this._current = current.prev","  }","  this._next = this._current.next","  // unshift","  current.next = this._head","  current.prev = undefined","  this._head.prev = current","  this._head = current","  return current.data","}","","module.exports.prototype.removeCurrent = function (data) {","  var current = this._current","  if (this._length === 0) {","    return","  }","  this._length--","  if (this._length === 0) {","    this._head = this._tail = this._current = this._next = undefined","    return current.data","  }","  if (current === this._tail) {","    this._tail = current.prev","    this._tail.next = undefined","    this._current = this._tail","  } else if (current === this._head) {","    this._head = current.next","    this._head.prev = undefined","    this._current = this._head","  } else {","    current.next.prev = current.prev","    current.prev.next = current.next","    this._current = current.prev","  }","  this._next = this._current.next","  return current.data","}","","module.exports.prototype.next = function () {","  var next = this._next","  if (next !== undefined) {","    this._next = next.next","    this._current = next","    return next.data","  }","}","","module.exports.prototype.resetCursor = function () {","  this._current = this._next = this._head","  return this","}","","function Item (data, prev, next) {","  this.next = next","  if (next) next.prev = this","  this.prev = prev","  if (prev) prev.next = this","  this.data = data","}"]},{}],60:[function(require,module,exports){module.exports=function(){Object.defineProperty(this,"_head",{value:undefined,writable:true,enumerable:false,configurable:false});Object.defineProperty(this,"_tail",{value:undefined,writable:true,enumerable:false,configurable:false});Object.defineProperty(this,"_next",{value:undefined,writable:true,enumerable:false,configurable:false});Object.defineProperty(this,"_length",{value:0,writable:true,enumerable:false,configurable:false})};module.exports.prototype.__defineGetter__("head",function(){return this._head&&this._head.data});module.exports.prototype.__defineGetter__("tail",function(){return this._tail&&this._tail.data});module.exports.prototype.__defineGetter__("current",function(){return this._current&&this._current.data});module.exports.prototype.__defineGetter__("length",function(){return this._length});module.exports.prototype.push=function(data){this._tail=new Item(data,this._tail);if(this._length===0){this._head=this._tail;this._current=this._head;this._next=this._head}this._length++};module.exports.prototype.pop=function(){var tail=this._tail;if(this._length===0){return}this._length--;if(this._length===0){this._head=this._tail=this._current=this._next=undefined;return tail.data}this._tail=tail.prev;this._tail.next=undefined;if(this._current===tail){this._current=this._tail;this._next=undefined}return tail.data};module.exports.prototype.shift=function(){var head=this._head;if(this._length===0){return}this._length--;if(this._length===0){this._head=this._tail=this._current=this._next=undefined;return head.data}this._head=this._head.next;if(this._current===head){this._current=this._head;this._next=this._current.next}return head.data};module.exports.prototype.unshift=function(data){this._head=new Item(data,undefined,this._head);if(this._length===0){this._tail=this._head;this._next=this._head}this._length++};module.exports.prototype.unshiftCurrent=function(){var current=this._current;if(current===this._head||this._length<2){return current&&current.data}if(current===this._tail){this._tail=current.prev;this._tail.next=undefined;this._current=this._tail}else{current.next.prev=current.prev;current.prev.next=current.next;this._current=current.prev}this._next=this._current.next;current.next=this._head;current.prev=undefined;this._head.prev=current;this._head=current;return current.data};module.exports.prototype.removeCurrent=function(data){var current=this._current;if(this._length===0){return}this._length--;if(this._length===0){this._head=this._tail=this._current=this._next=undefined;return current.data}if(current===this._tail){this._tail=current.prev;this._tail.next=undefined;this._current=this._tail}else if(current===this._head){this._head=current.next;this._head.prev=undefined;this._current=this._head;
}else{current.next.prev=current.prev;current.prev.next=current.next;this._current=current.prev}this._next=this._current.next;return current.data};module.exports.prototype.next=function(){var next=this._next;if(next!==undefined){this._next=next.next;this._current=next;return next.data}};module.exports.prototype.resetCursor=function(){this._current=this._next=this._head;return this};function Item(data,prev,next){this.next=next;if(next)next.prev=this;this.prev=prev;if(prev)prev.next=this;this.data=data}},{}]},{},[8])(8)});
